UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};var baidu=baidu||{};baidu.editor=baidu.editor||{};baidu.editor.commands={};baidu.editor.plugins={};baidu.editor.browser=function(){var d=navigator.userAgent.toLowerCase(),b=window.opera,c={ie:!!window.ActiveXObject,opera:(!!b&&b.version),webkit:(d.indexOf(" applewebkit/")>-1),air:(d.indexOf(" adobeair/")>-1),mac:(d.indexOf("macintosh")>-1),quirks:(document.compatMode=="BackCompat")};c.gecko=(navigator.product=="Gecko"&&!c.webkit&&!c.opera);var a=0;if(c.ie){a=parseFloat(d.match(/msie (\d+)/)[1]);c.ie8=!!document.documentMode;c.ie8Compat=document.documentMode==8;c.ie7Compat=((a==7&&!document.documentMode)||document.documentMode==7);c.ie6Compat=(a<7||c.quirks)}if(c.gecko){var e=d.match(/rv:([\d\.]+)/);if(e){e=e[1].split(".");a=e[0]*10000+(e[1]||0)*100+(e[2]||0)*1}}if(/chrome\/(\d+\.\d)/i.test(d)){c.chrome=+RegExp["\x241"]}if(/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(d)&&!/chrome/i.test(d)){c.safari=+(RegExp["\x241"]||RegExp["\x242"])}if(c.opera){a=parseFloat(b.version())}if(c.webkit){a=parseFloat(d.match(/ applewebkit\/(\d+)/)[1])}c.version=a;c.isCompatible=!c.mobile&&((c.ie&&a>=6)||(c.gecko&&a>=10801)||(c.opera&&a>=9.5)||(c.air&&a>=1)||(c.webkit&&a>=522)||false);return c}();(function(){baidu.editor.utils={};var b=new Function();var a=baidu.editor.utils={makeInstance:function(c){b.prototype=c;c=new b;b.prototype=null;return c},isArray:function(c){return c&&c.constructor===Array},isString:function(c){return typeof c=="string"||c.constructor==String},each:function(f,e,g){if(a.isArray(f)){for(var d=0;d<f.length;d++){e.call(g,f[d],d,f)}}else{for(var c in f){e.call(g,f[c],c,f)}}},inherits:function(f,d){var c=f.prototype;var e=a.makeInstance(d.prototype);a.extend(e,c,true);f.prototype=e;return(e.constructor=f)},bind:function(c,d){return function(){return c.apply(d,arguments)}},defer:function(d,c,e){var f;return function(){if(e){clearTimeout(f)}f=setTimeout(d,c)}},extend:function(e,f,c){if(f){for(var d in f){if(!c||!e.hasOwnProperty(d)){e[d]=f[d]}}}return e},indexOf:function(e,d,c){c=c||0;while(c<e.length){if(e[c]===d){return c}c++}return -1},removeItem:function(e,d){var c=e.length;if(c){while(c--){if(e[c]===d){e.splice(c,1);break}}}},trim:function(){var c=/(^[ \t\n\r]+)|([ \t\n\r]+$)/g;return function(d){return d.replace(c,"")}}(),listToMap:function(d){if(!d){return{}}var f=d.split(/,/g),c=f.length,e={};if(c){while(c--){e[f[c]]=1}}return e},unhtml:function(){var d={"<":"&lt;","&":"&amp",'"':"&quot;",">":"&gt;"};function c(e){return d[e]}return function(e){return e?e.replace(/[&<">]/g,c):""}}(),cssStyleToDomStyle:function(){var f=document.createElement("div").style,d=f.cssFloat!=undefined?"cssFloat":f.styleFloat!=undefined?"styleFloat":"float",c={"float":d};function e(g){return g.charAt(1).toUpperCase()}return function(g){return c[g]||(c[g]=g.toLowerCase().replace(/-./g,e))}}()}})();(function(){baidu.editor.EventBase=c;var a=baidu.editor.utils;function c(){}c.prototype={addListener:function(d,e){b(this,d,true).push(e)},removeListener:function(e,f){var d=b(this,e);d&&a.removeItem(d,f)},fireEvent:function(g){var f=b(this,g),h,e,d;if(f){d=f.length;while(d--){e=f[d].apply(this,arguments);if(e!==undefined){h=e}}}if(e=this["on"+g.toLowerCase()]){h=e.apply(this,arguments)}return h}};function b(g,e,f){var d;e=e.toLowerCase();return((d=(g.__allListeners||f&&(g.__allListeners={})))&&(d[e]||f&&(d[e]=[])))}})();baidu.editor.dom=baidu.editor.dom||{};baidu.editor.dom.dtd=(function(){function y(A){for(var z in A){A[z.toUpperCase()]=A[z]}return A}function a(D){var A=arguments;for(var C=1;C<A.length;C++){var z=A[C];for(var B in z){if(!D.hasOwnProperty(B)){D[B]=z[B]}}}return D}var x=y({isindex:1,fieldset:1}),w=y({input:1,button:1,select:1,textarea:1,label:1}),v=a(y({a:1}),w),u=a({iframe:1},v),t=y({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),s=y({ins:1,del:1,script:1,style:1}),r=a(y({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),s),q=a(y({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),r),p=a(y({p:1}),q),o=a(y({iframe:1}),q,w),n=y({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),m=a(y({a:0}),o),k=y({tr:1}),j=y({"#":1}),i=a(y({param:1}),n),h=a(y({form:1}),x,u,t,p),g=y({li:1}),f=y({style:1,script:1}),e=y({base:1,link:1,meta:1,title:1}),d=a(e,f),c=y({head:1,body:1}),b=y({html:1});var l=y({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1});return y({$nonBodyContent:a(b,c,e),$block:l,$inline:m,$body:a(y({script:1,style:1}),l),$cdata:y({script:1,style:1}),$empty:y({area:1,base:1,br:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1}),$listItem:y({dd:1,dt:1,li:1}),$list:y({ul:1,ol:1,dl:1}),$removeEmpty:y({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$tableContent:y({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),html:c,head:d,style:j,script:j,body:h,base:{},link:{},meta:{},title:j,col:{},tr:y({td:1,th:1}),img:{},embed:{},colgroup:y({col:1}),noscript:h,td:h,br:{},th:h,center:h,kbd:m,button:a(p,t),basefont:{},h5:m,h4:m,samp:m,h6:m,ol:g,h1:m,h3:m,option:j,h2:m,form:a(x,u,t,p),select:y({optgroup:1,option:1}),font:m,ins:m,menu:g,abbr:m,label:m,table:y({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:m,tfoot:k,cite:m,li:h,input:{},iframe:h,strong:m,textarea:j,noframes:h,big:m,small:m,span:{"#":1},hr:m,dt:m,sub:m,optgroup:y({option:1}),param:{},bdo:m,"var":m,div:h,object:i,sup:m,dd:h,strike:m,area:{},dir:g,map:a(y({area:1,form:1,p:1}),x,s,t),applet:i,dl:y({dt:1,dd:1}),del:m,isindex:{},fieldset:a(y({legend:1}),n),thead:k,ul:g,acronym:m,b:m,a:a(y({a:1}),o),blockquote:a(y({td:1,tr:1,tbody:1,li:1}),h),caption:m,i:m,u:m,tbody:k,s:m,address:a(u,p),tt:m,legend:m,q:m,pre:a(r,v),p:a(y({a:1}),m),em:m,dfn:m})})();baidu.editor.dom.domUtils=baidu.editor.dom.domUtils||{};(function(){var f=baidu.editor,d=f.browser,g=f.dom.dtd,c=f.utils,b;function h(o,p,j,i,m,n){var l=i&&o[p],k;!l&&(l=o[j]);while(!l&&(k=(k||o).parentNode)){if(k.tagName=="BODY"){return null}if(n&&!n(k)){return null}l=k[j]}if(l&&m&&!m(l)){return h(l,p,j,false,m)}return l}var e=d.ie&&d.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"};var a=baidu.editor.dom.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:d.ie&&d.version=="6"?"\ufeff":"\u200B",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(o,m){if(o===m){return 0}if(d.gecko){return o.compareDocumentPosition(m)}var k,n=[o],l=[m];k=o;while(k=k.parentNode){if(k===m){return 10}n.push(k)}k=m;while(k=k.parentNode){if(k===o){return 20}l.push(k)}n.reverse();l.reverse();if(n[0]!==l[0]){return 1}var j=-1;while(j++,n[j]===l[j]){}o=n[j];m=l[j];while(o=o.nextSibling){if(o===m){return 4}}return 2},getNodeIndex:function(k){var l=k.parentNode.childNodes,j=0;while(l[j]!==k){j++}return j},findParent:function(k,i,j){if(!this.isBody(k)){k=j?k:k.parentNode;while(k){if(!i||i(k)||this.isBody(k)){return i&&!i(k)&&this.isBody(k)?null:k}k=k.parentNode}}return null},findParentByTagName:function(k,j,i){if(k&&k.nodeType&&!this.isBody(k)&&(k.nodeType==1||k.nodeType)){j=!c.isArray(j)?[j]:j;k=k.nodeType==3||!i?k.parentNode:k;while(k&&k.tagName&&k.nodeType!=9){if(c.indexOf(j,k.tagName.toLowerCase())>-1){return k}k=k.parentNode}}return null},findParents:function(m,l,i,k){var j=l&&(i&&i(m)||!i)?[m]:[];while(m=a.findParent(m,i)){j.push(m)}if(!k){j.reverse()}return j},insertAfter:function(j,i){return j.parentNode.insertBefore(i,j.nextSibling)},remove:function(j,k){var i=j.parentNode,l;if(i){if(k&&j.hasChildNodes()){while(l=j.firstChild){i.insertBefore(l,j)}}i.removeChild(j)}return j},getNextDomNode:function(l,i,j,k){return h(l,"firstChild","nextSibling",i,j,k)},getPreviousDomNode:function(k,i,j){return h(k,"lastChild","previousSibling",i,j)},isBookmarkNode:function(i){return i.nodeType==1&&i.id&&/^_baidu_bookmark_/i.test(i.id)},getWindow:function(i){var j=i.ownerDocument||i;return j.defaultView||j.parentWindow},getCommonAncestor:function(o,m){if(o===m){return o}var n=[o],l=[m],k=o,j=-1;while(k=k.parentNode){if(k===m){return k}n.push(k)}k=m;while(k=k.parentNode){if(k===o){return k}l.push(k)}n.reverse();l.reverse();while(j++,n[j]===l[j]){}return j==0?null:n[j-1]},clearEmptySibling:function(l,j,k){function i(o,m){var n;if(o&&(!a.isBookmarkNode(o)&&a.isEmptyInlineElement(o)||a.isWhitespace(o))){n=o[m];a.remove(o);n&&i(n,m)}}!j&&i(l.nextSibling,"nextSibling");!k&&i(l.previousSibling,"previousSibling")},split:function(l,n){var m=l.ownerDocument;if(d.ie&&n==l.nodeValue.length){var k=m.createTextNode("");return a.insertAfter(l,k)}var i=l.splitText(n);if(d.ie8){var j=m.createTextNode("");a.insertAfter(i,j);a.remove(j)}return i},isWhitespace:function(j){var i=new RegExp("[^ \t\n\r"+a.fillChar+"]");return !i.test(j.nodeValue)},getXY:function(i){var j=i.getBoundingClientRect();return{x:Math.round(j.left),y:Math.round(j.top)}},on:function(n,m,l){var j=m instanceof Array?m:[m],i=j.length;var o;if(!n.addEventListener){o=function(k){k=k||window.event;var p=k.srcElement;return l.call(p,k)};l._d=o}if(i){while(i--){m=j[i];if(n.addEventListener){n.addEventListener(m,l,false)}else{n.attachEvent("on"+m,o)}}}n=null},un:function(n,m,l){var j=m instanceof Array?m:[m],i=j.length;if(i){while(i--){m=j[i];if(n.removeEventListener){n.removeEventListener(m,l,false)}else{n.detachEvent("on"+m,l._d||l)}}}},isSameElement:function(j,i){if(j.tagName!=i.tagName){return false}var q=j.attributes,o=i.attributes;if(!d.ie&&q.length!=o.length){return false}var l=q.length,r=0;if(l){while(l--){var p=q[l];if(!d.ie||p.specified){r++;if(p.nodeName=="style"){continue}var n=i.attributes[p.nodeName];var m=n&&n.nodeValue||null;if(m!=p.nodeValue){return false}}}}if(!a.isSameStyle(j,i)){return false}if(d.ie){l=o.length;if(l){while(l--){if(o[l].specified){r--}}}return !r}return true},isRedundantSpan:function(i){if(i.nodeType==3||i.tagName.toLowerCase()!="span"){return 0}if(d.ie){return i.style.cssText==""?1:0}return !i.attributes.length},isSameStyle:function(m,l){var k=m.style.cssText,i=l.style.cssText;if(!k&&!i){return true}else{if(!k||!i){return false}}var p={},j=[],n={};k.replace(/[\w-]+\s*(?=:)/g,function(q){p[q]=j.push(q)});try{i.replace(/[\w-]+\s*(?=:)/g,function(r){var q=p[r];if(q){r=c.cssStyleToDomStyle(r);if(m.style[r]!==l.style[r]){throw n}j[q-1]=""}else{throw n}})}catch(o){if(o===n){return false}}return !j.join("")},isBlockElm:function(){var j=["block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"],i={hr:1};return function(l,k){return l.nodeType==1&&(c.indexOf(j,a.getComputedStyle(l,"display"))!=-1||c.extend(i,k||{})[l.tagName.toLocaleLowerCase()])}}(),isBody:function(i){return i&&i.nodeType==1&&i.tagName.toLowerCase()=="body"},breakParent:function(m,k){var j,o=m,n=m,i,l;do{o=o.parentNode;if(i){j=o.cloneNode(false);j.appendChild(i);i=j;j=o.cloneNode(false);j.appendChild(l);l=j}else{i=o.cloneNode(false);l=i.cloneNode(false)}while(j=n.previousSibling){i.insertBefore(j,i.firstChild)}while(j=n.nextSibling){l.appendChild(j)}n=o}while(k!==o);j=k.parentNode;j.insertBefore(i,k);j.insertBefore(l,k);j.insertBefore(m,l);a.remove(k);return m},isEmptyInlineElement:function(i){if(i.nodeType!=1||!g.$removeEmpty[i.tagName]){return 0}i=i.firstChild;while(i){if(a.isBookmarkNode(i)){return 0}if(i.nodeType==1&&!a.isEmptyInlineElement(i)||i.nodeType==3&&!a.isWhitespace(i)){return 0}i=i.nextSibling}return 1},trimWhiteTextNode:function(j){function i(k){var l;while((l=j[k])&&l.nodeType==3&&a.isWhitespace(l)){j.removeChild(l)}}i("firstChild");i("lastChild")},mergChild:function(n,l,t){var q=a.getElementsByTagName(n,n.tagName.toLowerCase());for(var p=0,v;v=q[p++];){if(!v.parentNode||a.isBookmarkNode(v)){continue}if(v.tagName.toLowerCase()=="span"){if(n===v.parentNode){a.trimWhiteTextNode(n);if(n.childNodes.length==1){n.style.cssText=v.style.cssText+";"+n.style.cssText;a.remove(v,true);continue}}v.style.cssText=n.style.cssText+";"+v.style.cssText;if(t){var k=t.style;if(k){k=k.split(";");for(var o=0,u;u=k[o++];){v.style[c.cssStyleToDomStyle(u.split(":")[0])]=u.split(":")[1]}}}if(a.isSameStyle(v,n)){a.remove(v,true)}continue}if(a.isSameElement(n,v)){a.remove(v,true)}}if(l=="span"){var m=a.getElementsByTagName(n,"a");for(var p=0,r;r=m[p++];){r.style.cssText=";"+n.style.cssText;r.style.textDecoration="underline"}}},getElementsByTagName:function(n,k){var o=n.getElementsByTagName(k),j=[];for(var m=0,l;l=o[m++];){j.push(l)}return j},mergToParent:function(j){var i=j.parentNode;while(i&&g.$removeEmpty[i.tagName]){if(i.tagName==j.tagName||i.tagName=="A"){a.trimWhiteTextNode(i);if(i.tagName.toLowerCase()=="span"&&!a.isSameStyle(i,j)||(i.tagName=="A"&&j.tagName=="SPAN")){if(i.childNodes.length>1||i!==j.parentNode){j.style.cssText=i.style.cssText+";"+j.style.cssText;i=i.parentNode;continue}else{i.style.cssText+=";"+j.style.cssText;if(i.tagName=="A"){i.style.textDecoration="underline"}}}i.tagName!="A"&&a.remove(j,true)}i=i.parentNode}},mergSibling:function(k,j,i){function l(o,p,n){var m;if((m=n[o])&&!a.isBookmarkNode(m)&&m.nodeType==1&&a.isSameElement(n,m)){while(m.firstChild){if(p=="firstChild"){n.insertBefore(m.lastChild,n.firstChild)}else{n.appendChild(m.firstChild)}}a.remove(m)}}!j&&l("previousSibling","firstChild",k);!i&&l("nextSibling","lastChild",k)},unselectable:d.gecko?function(i){i.style.MozUserSelect="none"}:d.webkit?function(i){i.style.KhtmlUserSelect="none"}:function(l){l.unselectable="on";for(var k=0,j;j=l.all[k++];){switch(j.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:j.unselectable="on"}}},removeAttributes:function(l,m){var j=m.length;if(j){while(j--){var i=m[j];i=e[i]||i;l.removeAttribute(i)}}},setAttributes:function(k,j){for(var i in j){switch(i){case"class":k.className=j[i];break;case"style":k.style.cssText=j[i];break;default:k.setAttribute(i,j[i])}}return k},getComputedStyle:function(){function i(j,k){return k}if(window.getComputedStyle){return function(k,j){return i(j,a.getStyle(k,j)||a.getWindow(k).getComputedStyle(k,"").getPropertyValue(j))}}return function(k,j){return i(j,a.getStyle(k,j)||(k.currentStyle||k.style)[c.cssStyleToDomStyle(j)])}}(),removeClasses:function(i,j){i.className=(" "+i.className+" ").replace(new RegExp("(?:\\s+(?:"+j.join("|")+"))+\\s+","g")," ")},removeStyle:function(j,i){j.style[c.cssStyleToDomStyle(i)]="";if(j.style.removeAttribute){j.style.removeAttribute(c.cssStyleToDomStyle(i))}if(!j.style.cssText){j.removeAttribute("style")}},hasClass:function(i,j){return(" "+i.className+" ").indexOf(" "+j+" ")>-1},preventDefault:function(i){if(i.preventDefault){i.preventDefault()}else{i.returnValue=false}},getStyle:function(m,k){var n=m.style[c.cssStyleToDomStyle(k)];if(/color/i.test(k)&&n.indexOf("rgb(")!=-1){var o=n.split(",");n="#";for(var l=0,j;j=o[l];l++){j=parseInt(j.replace(/[^\d]/gi,""),10).toString(16);n+=j.length==1?"0"+j:j}n=n.toUpperCase()}return n},removeDirtyAttr:function(m){for(var l=0,k,j=m.getElementsByTagName("*");k=j[l++];){k.removeAttribute("_moz_dirty")}m.removeAttribute("_moz_dirty")},getChildCount:function(k,i){var j=0,l=k.firstChild;i=i||function(){return 1};while(l){if(i(l)){j++}l=l.nextSibling}return j},clearReduent:function(m,r){var k,l=new RegExp(a.fillChar,"g"),n;for(var p=0,j;j=r[p++];){k=m.getElementsByTagName(j);for(var o=0,q;q=k[o++];){if(q.parentNode&&q[d.ie?"innerText":"textContent"].replace(l,"").length==0&&q.children.length==0){n=q.parentNode;a.remove(q);while(n.childNodes.length==0&&new RegExp(r.join("|"),"i").test(n.tagName)){q=n;n=n.parentNode;a.remove(q)}}}}},isEmptyNode:function(i){var j=i.firstChild;return !j||a.getChildCount(i,function(k){return !a.isBr(k)&&!a.isBookmarkNode(k)&&!a.isWhitespace(k)})==0},clearSelectedArr:function(i){var j;while(j=i.pop()){j.className=""}},scrollToView:function(j,q,o){var i=function(){var r=q.document,s=r.compatMode=="CSS1Compat";return{width:(s?r.documentElement.clientWidth:r.body.clientWidth)||0,height:(s?r.documentElement.clientHeight:r.body.clientHeight)||0}},p=function(s){if("pageXOffset" in s){return{x:s.pageXOffset||0,y:s.pageYOffset||0}}else{var r=s.document;return{x:r.documentElement.scrollLeft||r.body.scrollLeft||0,y:r.documentElement.scrollTop||r.body.scrollTop||0}}};var m=i().height,n=m*-1;n+=(j.offsetHeight||0);var k=a.getXY(j);n+=k.y;var l=p(q).y;if(n>l||n<l-m){q.scrollTo(0,n)}},isBr:function(i){return i.nodeType==1&&i.tagName=="BR"}}})();baidu.editor.dom.Range=baidu.editor.dom.Range||{};(function(){var h=baidu.editor,g=h.browser,e=h.dom.domUtils,a=h.dom.dtd,k=h.utils,i=0,j=e.fillChar;var c=function(m){m.collapsed=m.startContainer&&m.endContainer&&m.startContainer===m.endContainer&&m.startOffset==m.endOffset},b=function(n,o,p,m){if(o.nodeType==1&&a.$empty[o.tagName.toLowerCase()]){p=e.getNodeIndex(o)+(n?0:1);o=o.parentNode}if(n){m.startContainer=o;m.startOffset=p;if(!m.endContainer){m.collapse(true)}}else{m.endContainer=o;m.endOffset=p;if(!m.startContainer){m.collapse(false)}}c(m);return m},l=function(s,w){var q=s.startContainer,p=s.endContainer,y=s.startOffset,r=s.endOffset,E=s.document,m=E.createDocumentFragment(),t,v;if(q.nodeType==1){q=q.childNodes[y]||(t=q.appendChild(E.createTextNode("")))}if(p.nodeType==1){p=p.childNodes[r]||(v=p.appendChild(E.createTextNode("")))}if(q===p&&q.nodeType==3){m.appendChild(E.createTextNode(q.substringData(y,r-y)));if(w){q.deleteData(y,r-y);s.collapse(true)}return m}var u,A,C=m,B=e.findParents(q,true),n=e.findParents(p,true);for(var z=0;B[z]==n[z];z++){}for(var x=z,D;D=B[x];x++){u=D.nextSibling;if(D==q){if(!t){if(s.startContainer.nodeType==3){C.appendChild(E.createTextNode(q.nodeValue.slice(y)));if(w){q.deleteData(y,q.nodeValue.length-y)}}else{C.appendChild(!w?q.cloneNode(true):q)}}}else{A=D.cloneNode(false);C.appendChild(A)}while(u){if(u===p||u===n[x]){break}D=u.nextSibling;C.appendChild(!w?u.cloneNode(true):u);u=D}C=A}C=m;if(!B[z]){C.appendChild(B[z-1].cloneNode(false));C=C.firstChild}for(var x=z,o;o=n[x];x++){u=o.previousSibling;if(o==p){if(!v&&s.endContainer.nodeType==3){C.appendChild(E.createTextNode(p.substringData(0,r)));if(w){p.deleteData(0,r)}}}else{A=o.cloneNode(false);C.appendChild(A)}if(x!=z||!B[z]){while(u){if(u===q){break}o=u.previousSibling;C.insertBefore(!w?u.cloneNode(true):u,C.firstChild);u=o}}C=A}if(w){s.setStartBefore(!n[z]?n[z-1]:!B[z]?B[z-1]:n[z]).collapse(true)}t&&e.remove(t);v&&e.remove(v);return m};var d=baidu.editor.dom.Range=function(m){var n=this;n.startContainer=n.startOffset=n.endContainer=n.endOffset=null;n.document=m;n.collapsed=true};function f(o){var n=o.parentNode,m;e.remove(o);while(n&&a.$removeEmpty[n.tagName]&&n.childNodes.length==0){m=n;e.remove(n);n=m.parentNode}}d.prototype={cloneContents:function(){return this.collapsed?null:l(this,0)},deleteContents:function(){if(!this.collapsed){l(this,1)}return this},extractContents:function(){return this.collapsed?null:l(this,2)},setStart:function(m,n){return b(true,m,n,this)},setEnd:function(m,n){return b(false,m,n,this)},setStartAfter:function(m){return this.setStart(m.parentNode,e.getNodeIndex(m)+1)},setStartBefore:function(m){return this.setStart(m.parentNode,e.getNodeIndex(m))},setEndAfter:function(m){return this.setEnd(m.parentNode,e.getNodeIndex(m)+1)},setEndBefore:function(m){return this.setEnd(m.parentNode,e.getNodeIndex(m))},selectNode:function(m){return this.setStartBefore(m).setEndAfter(m)},selectNodeContents:function(m){return this.setStart(m,0).setEnd(m,m.nodeType==3?m.nodeValue.length:m.childNodes.length)},cloneRange:function(){var n=this,m=new d(n.document);return m.setStart(n.startContainer,n.startOffset).setEnd(n.endContainer,n.endOffset)},collapse:function(m){var n=this;if(m){n.endContainer=n.startContainer;n.endOffset=n.startOffset}else{n.startContainer=n.endContainer;n.startOffset=n.endOffset}n.collapsed=true;return n},shrinkBoundary:function(n){var m=this,p,o=m.collapsed;while(m.startContainer.nodeType==1&&(p=m.startContainer.childNodes[m.startOffset])&&p.nodeType==1&&!e.isBookmarkNode(p)&&!a.$empty[p.tagName]){m.setStart(p,0)}if(o){return m.collapse(true)}if(!n){while(m.endContainer.nodeType==1&&m.endOffset>0&&(p=m.endContainer.childNodes[m.endOffset-1])&&p.nodeType==1&&!e.isBookmarkNode(p)&&!a.$empty[p.tagName]){m.setEnd(p,p.childNodes.length)}}return m},getCommonAncestor:function(n,o){var p=this.startContainer,m=this.endContainer;if(p===m){if(n&&p.nodeType==1&&this.startOffset==this.endOffset-1){return p.childNodes[this.startOffset]}return o&&p.nodeType==3?p.parentNode:p}return e.getCommonAncestor(p,m)},trimBoundary:function(n){this.txtToElmBoundary();var r=this.startContainer,q=this.startOffset,p=this.collapsed,m=this.endContainer;if(r.nodeType==3){if(q==0){this.setStartBefore(r)}else{if(q>=r.nodeValue.length){this.setStartAfter(r)}else{var o=e.split(r,q);if(r===m){this.setEnd(o,this.endOffset-q)}else{if(r.parentNode===m){this.endOffset+=1}}this.setStartBefore(o)}}if(p){return this.collapse(true)}}if(!n){q=this.endOffset;m=this.endContainer;if(m.nodeType==3){if(q==0){this.setEndBefore(m)}else{if(q>=m.nodeValue.length){this.setEndAfter(m)}else{e.split(m,q);this.setEndAfter(m)}}}}return this},txtToElmBoundary:function(){function m(o,q){var n=o[q+"Container"],p=o[q+"Offset"];if(n.nodeType==3){if(!p){o["set"+q.replace(/(\w)/,function(r){return r.toUpperCase()})+"Before"](n)}else{if(p>=n.nodeValue.length){o["set"+q.replace(/(\w)/,function(r){return r.toUpperCase()})+"After"](n)}}}}if(!this.collapsed){m(this,"start");m(this,"end")}return this},insertNode:function(o){var q=o,n=1;if(o.nodeType==11){q=o.firstChild;n=o.childNodes.length}this.trimBoundary(true);var r=this.startContainer,p=this.startOffset;var m=r.childNodes[p];if(m){r.insertBefore(o,m)}else{r.appendChild(o)}if(q.parentNode===this.endContainer){this.endOffset=this.endOffset+n}return this.setStartBefore(q)},setCursor:function(m){return this.collapse(m?false:true).select()},createBookmark:function(o,p){var m,n=this.document.createElement("span");n.style.cssText="display:none;line-height:0px;";n.appendChild(this.document.createTextNode("\uFEFF"));n.id="_baidu_bookmark_start_"+(p?"":i++);if(!this.collapsed){m=n.cloneNode(true);m.id="_baidu_bookmark_end_"+(p?"":i++)}this.insertNode(n);if(m){this.collapse(false).insertNode(m);this.setEndBefore(m)}this.setStartAfter(n);return{start:o?n.id:n,end:m?o?m.id:m:null,id:o}},moveToBookmark:function(n){var o=n.id?this.document.getElementById(n.start):n.start,m=n.end&&n.id?this.document.getElementById(n.end):n.end;this.setStartBefore(o);e.remove(o);if(m){this.setEndBefore(m);e.remove(m)}else{this.collapse(true)}return this},enlarge:function(n,q){var m=e.isBody,r,p,o=this.document.createTextNode("");if(n){p=this.startContainer;if(p.nodeType==1){if(p.childNodes[this.startOffset]){r=p=p.childNodes[this.startOffset]}else{p.appendChild(o);r=p=o}}else{r=p}while(1){if(e.isBlockElm(p)){p=r;while((r=p.previousSibling)&&!e.isBlockElm(r)){p=r}this.setStartBefore(p);break}r=p;p=p.parentNode}p=this.endContainer;if(p.nodeType==1){if(r=p.childNodes[this.endOffset]){p.insertBefore(o,r)}else{p.appendChild(o)}r=p=o}else{r=p}while(1){if(e.isBlockElm(p)){p=r;while((r=p.nextSibling)&&!e.isBlockElm(r)){p=r}this.setEndAfter(p);break}r=p;p=p.parentNode}if(o.parentNode===this.endContainer){this.endOffset--}e.remove(o)}if(!this.collapsed){while(this.startOffset==0){if(q&&q(this.startContainer)){break}if(m(this.startContainer)){break}this.setStartBefore(this.startContainer)}while(this.endOffset==(this.endContainer.nodeType==1?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)){if(q&&q(this.endContainer)){break}if(m(this.endContainer)){break}this.setEndAfter(this.endContainer)}}return this},adjustmentBoundary:function(){if(!this.collapsed){while(!e.isBody(this.startContainer)&&this.startOffset==this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length){this.setStartAfter(this.startContainer)}while(!e.isBody(this.endContainer)&&!this.endOffset){this.setEndBefore(this.endContainer)}}return this},applyInlineStyle:function(n,y,u){if(this.collapsed){return this}this.trimBoundary().enlarge(false,function(C){return C.nodeType==1&&e.isBlockElm(C)}).adjustmentBoundary();var v=this.createBookmark(),q=v.end,A=function(C){return C.nodeType==1?C.tagName.toLowerCase()!="br":!e.isWhitespace(C)},t=e.getNextDomNode(v.start,false,A),o,p,s=this.cloneRange();while(t&&(e.getPosition(t,q)&e.POSITION_PRECEDING)){if(t.nodeType==3||a[n][t.tagName]){s.setStartBefore(t);o=t;while(o&&(o.nodeType==3||a[n][o.tagName])&&o!==q){p=o;o=e.getNextDomNode(o,o.nodeType==1,null,function(C){return a[n][C.tagName]})}var z=s.setEndAfter(p).extractContents(),w;if(u&&u.length>0){var m,x;x=m=u[0].cloneNode(false);for(var r=1,B;B=u[r++];){m.appendChild(B.cloneNode(false));m=m.firstChild}w=m}else{w=s.document.createElement(n)}if(y){e.setAttributes(w,y)}w.appendChild(z);e.mergChild(w,n,y);s.insertNode(u?x:w);e.mergSibling(w);e.clearEmptySibling(w);t=e.getNextDomNode(w,false,A);e.mergToParent(w);if(o===q){break}}else{t=e.getNextDomNode(t,true,A)}}return this.moveToBookmark(v)},removeInlineStyle:function(n){if(this.collapsed){return this}n=k.isArray(n)?n:[n];this.shrinkBoundary().adjustmentBoundary();var t=this.startContainer,m=this.endContainer;while(1){if(t.nodeType==1){if(k.indexOf(n,t.tagName.toLowerCase())>-1){break}if(t.tagName.toLowerCase()=="body"){t=null;break}}t=t.parentNode}while(1){if(m.nodeType==1){if(k.indexOf(n,m.tagName.toLowerCase())>-1){break}if(m.tagName.toLowerCase()=="body"){m=null;break}}m=m.parentNode}var p=this.createBookmark(),s,r;if(t){r=this.cloneRange().setEndBefore(p.start).setStartBefore(t);s=r.extractContents();r.insertNode(s);e.clearEmptySibling(t,true);t.parentNode.insertBefore(p.start,t)}if(m){r=this.cloneRange().setStartAfter(p.end).setEndAfter(m);s=r.extractContents();r.insertNode(s);e.clearEmptySibling(m,false,true);m.parentNode.insertBefore(p.end,m.nextSibling)}var q=e.getNextDomNode(p.start,false,function(u){return u.nodeType==1}),o;while(q&&q!==p.end){o=e.getNextDomNode(q,true,function(u){return u.nodeType==1});if(k.indexOf(n,q.tagName.toLowerCase())>-1){e.remove(q,true)}q=o}return this.moveToBookmark(p)},getClosedNode:function(){var n;if(!this.collapsed){var m=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(m.startContainer.nodeType==1&&m.startContainer===m.endContainer&&m.endOffset-m.startOffset==1){var o=m.startContainer.childNodes[m.startOffset];if(o&&o.nodeType==1&&a.$empty[o.tagName]){n=o}}}return n},select:g.ie?function(m){var r=this.collapsed,u;if(!r){this.shrinkBoundary()}var p=this.getClosedNode();if(p){try{u=this.document.body.createControlRange();u.addElement(p);u.select()}catch(v){}return this}var w=this.createBookmark(),o=w.start,q;u=this.document.body.createTextRange();u.moveToElementText(o);u.moveStart("character",1);if(!r){var t=this.document.body.createTextRange();q=w.end;t.moveToElementText(q);u.setEndPoint("EndToEnd",t)}else{if(!m&&this.startContainer.nodeType!=3){var n=h.fillData,x,s=this.document.createElement("span");try{if(n&&n.parentNode&&!n.nodeValue.replace(new RegExp(e.fillChar,"g"),"").length){f(n)}}catch(v){}x=h.fillData=this.document.createTextNode(j);s.appendChild(this.document.createTextNode(j));o.parentNode.insertBefore(s,o);o.parentNode.insertBefore(x,o);u.moveStart("character",-1);u.collapse(true)}}this.moveToBookmark(w);s&&e.remove(s);u.select();return this}:function(o){var s=e.getWindow(this.document),r=s.getSelection(),q,t;g.gecko?this.document.body.focus():s.focus();function n(u){if(u&&u.nodeType==3&&!u.nodeValue.replace(new RegExp(e.fillChar,"g"),"").length){e.remove(u)}}if(r){r.removeAllRanges();if(this.collapsed&&!o){var m=h.fillData;q=this.document.createTextNode(j);h.fillData=q;this.insertNode(q);if(m&&m.parentNode){if(!m.nodeValue.replace(new RegExp(e.fillChar,"g"),"").length){f(m)}else{m.nodeValue=m.nodeValue.replace(new RegExp(e.fillChar,"g"),"")}}n(q.previousSibling);n(q.nextSibling);this.setStart(q,g.webkit?1:0).collapse(true)}var p=this.document.createRange();p.setStart(this.startContainer,this.startOffset);p.setEnd(this.endContainer,this.endOffset);r.addRange(p)}return this},scrollToView:function(o,p){o=o?window:e.getWindow(this.document);var m=this.document.createElement("span");m.innerHTML="position";var n=this.cloneRange();n.insertNode(m);e.scrollToView(m,o);e.remove(m);return this}}})();baidu.editor.dom.Selection=baidu.editor.dom.Selection||{};(function(){baidu.editor.dom.Selection=b;var a=baidu.editor.dom.domUtils,e=baidu.editor.dom.dtd,g=baidu.editor.browser.ie;function f(r,j){var k=a.getNodeIndex;r=r.duplicate();r.collapse(j);var v=r.parentElement();if(!v.hasChildNodes()){return{container:v,offset:0}}var u=v.children,l,n=r.duplicate(),w=0,q=u.length-1,s=-1,h;while(w<=q){s=Math.floor((w+q)/2);l=u[s];n.moveToElementText(l);var p=n.compareEndPoints("StartToStart",r);if(p>0){q=s-1}else{if(p<0){w=s+1}else{return{container:v,offset:k(l)}}}}if(s==-1){n.moveToElementText(v);n.setEndPoint("StartToStart",r);h=n.text.replace(/(\r\n|\r)/g,"\n").length;u=v.childNodes;if(!h){l=u[u.length-1];return{container:l,offset:l.nodeValue.length}}var o=u.length;while(h>0){h-=u[--o].nodeValue.length}return{container:u[o],offset:-h}}n.collapse(p>0);n.setEndPoint(p>0?"StartToStart":"EndToStart",r);h=n.text.replace(/(\r\n|\r)/g,"\n").length;if(!h){return e.$empty[l.tagName]?{container:v,offset:k(l)+(p>0?0:1)}:{container:l,offset:p>0?0:l.childNodes.length}}while(h>0){try{var m=l;l=l[p>0?"previousSibling":"nextSibling"];h-=l.nodeValue.length}catch(t){return{container:v,offset:k(m)}}}return{container:l,offset:p>0?-h:l.nodeValue.length+h}}function d(j,i){if(j.item){i.selectNode(j.item(0))}else{var h=f(j,true);i.setStart(h.container,h.offset);if(j.compareEndPoints("StartToEnd",j)!=0){h=f(j,false);i.setEnd(h.container,h.offset)}}return i}function c(j){var i=j.getNative().createRange();var h=i.item?i.item(0):i.parentElement();if((h.ownerDocument||h)===j.document){return i}}function b(j){var i=this,h;i.document=j;if(g){h=a.getWindow(j).frameElement;a.on(h,"beforedeactivate",function(){i._bakIERange=i.getIERange()});a.on(h,"activate",function(){try{if(!c(i)&&i._bakIERange){i._bakIERange.select()}}catch(k){}i._bakIERange=null})}h=j=null}b.prototype={getNative:function(){if(g){return this.document.selection}else{return a.getWindow(this.document).getSelection()}},getIERange:function(){var h=c(this);if(!h){if(this._bakIERange){return this._bakIERange}}return h},cache:function(){this.clear();this._cachedRange=this.getRange();this._cachedStartElement=this.getStart()},clear:function(){this._cachedRange=this._cachedStartElement=null},getRange:function(){var k=this;function j(o){var q=k.document.body.firstChild,p=o.collapsed;while(q&&q.firstChild){o.setStart(q,0);q=q.firstChild}if(!o.startContainer){o.setStart(k.document.body,0)}if(p){o.collapse(true)}}if(k._cachedRange!=null){return this._cachedRange}var i=new baidu.editor.dom.Range(k.document);if(g){var m=k.getIERange();if(m){d(m,i)}else{j(i)}}else{var l=k.getNative();if(l&&l.rangeCount){var h=l.getRangeAt(0);var n=l.getRangeAt(l.rangeCount-1);i.setStart(h.startContainer,h.startOffset).setEnd(n.endContainer,n.endOffset);if(i.collapsed&&a.isBody(i.startContainer)&&!i.startOffset){j(i)}}else{j(i)}}return i},getStart:function(){if(this._cachedStartElement){return this._cachedStartElement}var h=g?this.getIERange():this.getRange(),k,l,i,j;if(g){if(!h){return this.document.body.firstChild}if(h.item){return h.item(0)}k=h.duplicate();k.text.length>0&&k.moveStart("character",1);k.collapse(1);l=k.parentElement();j=i=h.parentElement();while(i=i.parentNode){if(i==l){l=j;break}}}else{h.shrinkBoundary();l=h.startContainer;if(l.nodeType==1&&l.hasChildNodes()){l=l.childNodes[Math.min(l.childNodes.length-1,h.startOffset)]}if(l.nodeType==3){return l.parentNode}}return l},getText:function(){var h=this.getNative(),i=baidu.editor.browser.ie?h.createRange():h.getRangeAt(0);return i.text||i.toString()}}})();(function(){baidu.editor.Editor=f;var g=baidu.editor,j=g.utils,d=g.EventBase,c=g.dom.domUtils,k=g.dom.Selection,b=g.browser.ie,h=0,e=g.browser,a=g.dom.dtd,i;function f(l){var m=this;m.uid=h++;d.call(m);m.commands={};m.options=j.extend(l||{},UEDITOR_CONFIG,true);m.initPlugins()}f.prototype={render:function(l){if(l.constructor===String){l=document.getElementById(l)}var o="baidu_editor_"+this.uid;l.innerHTML='<iframe id="'+o+'"width="100%" height="100%" scroll="no" frameborder="0"></iframe>';l.style.overflow="hidden";var m=document.getElementById(o),n=m.contentWindow.document;this._setup(n)},_setup:function(r){var m=this.options,q=this;r.open();var n=(b?"":"<!DOCTYPE html>")+'<html xmlns="http://www.w3.org/1999/xhtml"><head><title></title><style type="text/css">'+(b&&e.version<9?"body":"html")+"{ word-wrap: break-word;word-break: break-all;cursor: text; height: 100%; }"+(m.initialStyle)+"</style>"+(m.iframeCssUrl?'<link rel="stylesheet" type="text/css" href="'+j.unhtml(m.iframeCssUrl)+'"/>':"")+"</head><body></body></html>";r.write(n);r.close();if(b){r.body.disabled=true;r.body.contentEditable=true;r.body.disabled=false}else{r.body.contentEditable=true;r.body.spellcheck=false}this.document=r;this.window=r.defaultView||r.parentWindow;this.iframe=this.window.frameElement;if(this.options.minFrameHeight){this.setHeight(this.options.minFrameHeight)}this.body=r.body;this.selection=new k(r);this._initEvents();if(this.options.initialContent){if(this.options.autoClearinitialContent){this.setDefaultContent(this.options.initialContent)}else{this.document.body.innerHTML=this.options.initialContent}}var p=c.findParentByTagName(this.iframe,"form");if(p){c.on(p,"submit",function(){if(!i){i=document.createElement("textarea");i.setAttribute("name",q.options.textarea);i.style.display="none";this.appendChild(i)}i.value=q.getContent()})}if(c.getChildCount(this.body,function(s){return !c.isBr(s)})==0){this.body.innerHTML="<p>"+(e.ie?"":"<br/>")+"</p>"}if(q.options.focus){var l=this.selection.getRange(),o=this.body.lastChild;while(o.lastChild){o=o.lastChild}l[c.isBr(o)?"setStartBefore":"setStartAfter"](o).setCursor()}this.fireEvent("ready")},sync:function(){var l=c.findParentByTagName(this.iframe,"form");if(l){if(!i){i=document.createElement("textarea");i.setAttribute("name",this.options.textarea);i.style.display="none";l.appendChild(i)}i.value=this.getContent()}},setHeight:function(l){this.iframe.parentNode.style.height=l+"px"},getContent:function(){this.fireEvent("beforegetcontent");var m=new RegExp(c.fillChar,"g"),l=this.document.body.innerHTML.replace(m,"");this.fireEvent("aftergetcontent");if(this.serialize){var n=this.serialize.parseHTML(l);n=this.serialize.transformOutput(n);l=this.serialize.toHTML(n)}return l},getContentTxt:function(){var l=new RegExp(c.fillChar,"g");return this.document.body[e.ie?"innerText":"textContent"].replace(l,"")},setContent:function(l){var q=this;q.fireEvent("beforesetcontent");var n=this.serialize;if(n){var o=n.parseHTML(l);o=n.transformInput(o);o=n.filter(o);l=n.toHTML(o)}this.document.body.innerHTML=l;if(q.options.enterTag=="p"){var s=this.body.firstChild,r=q.document.createElement("p"),m;while(s){if(s.nodeType==3||s.nodeType==1&&a.p[s.tagName]){m=s.nextSibling;r.appendChild(s);s=m;if(!s){q.body.appendChild(r)}}else{if(r.firstChild){q.body.insertBefore(r,s);r=q.document.createElement("p")}s=s.nextSibling}}}q.adjustTable&&q.adjustTable(q.body);q.fireEvent("aftersetcontent")},focus:function(){c.getWindow(this.document).focus()},initPlugins:function(m){var o,l=baidu.editor.plugins;if(m){for(var n=0,p;p=m[n++];){if(j.indexOf(this.options.plugins,p)==-1&&(o=baidu.editor.plugins[p])){this.options.plugins.push(p);o.call(this)}}}else{m=this.options.plugins;if(m){for(n=0;p=l[m[n++]];){p.call(this)}}else{this.options.plugins=[];for(p in l){this.options.plugins.push(p);l[p].call(this)}}}},_initEvents:function(){var n=this,r=this.document,q=c.getWindow(r);var m=j.defer(j.bind(n._selectionChange,n),250,true);n._proxyDomEvent=j.bind(n._proxyDomEvent,n);c.on(r,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],n._proxyDomEvent);c.on(q,["focus","blur"],n._proxyDomEvent);c.on(r,["mouseup","keydown"],function(s){var t=s.keyCode||s.which;if(s.type=="keydown"&&(s.ctrlKey||s.metaKey||s.shiftKey||s.altKey)){return}if(s.button==2){return}m()});var l=0,o=e.ie?n.body:n.document,p;c.on(o,"dragstart",function(){l=1});c.on(o,e.webkit?"dragover":"drop",function(){return e.webkit?function(){clearTimeout(p);p=setTimeout(function(){if(!l){var w=n.selection,s=w.getRange();if(s){var t=s.getCommonAncestor();if(t&&n.serialize){var v=n.serialize,u=v.filter(v.transformInput(v.parseHTML(v.word(t.innerHTML))));t.innerHTML=v.toHTML(u)}}}l=0},200)}:function(s){if(!l){s.preventDefault?s.preventDefault():(s.returnValue=false)}l=0}}())},_proxyDomEvent:function(l){return this.fireEvent(l.type.replace(/^on/,""),l)},_selectionChange:function(){var l=this;try{}catch(m){}l.selection.cache();if(l.selection._cachedRange&&l.selection._cachedStartElement){l.fireEvent("beforeselectionchange");l.fireEvent("selectionchange");l.selection.clear()}},_callCmdFn:function(p,m){var l=m[0].toLowerCase(),o,n;n=(o=this.commands[l])&&o[p]||(o=baidu.editor.commands[l])&&o[p];if(o&&!n&&p=="queryCommandState"){return false}else{if(n){return n.apply(this,m)}}},execCommand:function(m){m=m.toLowerCase();var n=this,l,o=n.commands[m]||baidu.editor.commands[m];if(!o||!o.execCommand){return}if(!o.notNeedUndo&&!n.__hasEnterExecCommand){n.__hasEnterExecCommand=true;n.fireEvent("beforeexeccommand",m);l=this._callCmdFn("execCommand",arguments);n.fireEvent("afterexeccommand",m);n.__hasEnterExecCommand=false}else{l=this._callCmdFn("execCommand",arguments)}n._selectionChange();return l},queryCommandState:function(l){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(l){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(){var l=this.body[e.ie?"innerText":"textContent"],m=new RegExp("[ \t\n\r"+c.fillChar+"]","g");return !!l.replace(m,"").length},reset:function(){this.fireEvent("reset");this._selectionChange()},setDefaultContent:function(){function l(o,m){var p=this;if(o=="beforeselectionchange"&&m){return}if(p.document.getElementById("initContent")){p.document.body.innerHTML="<p>"+(baidu.editor.browser.ie?"":"<br/>")+"</p>";var n=p.selection.getRange();n.setStart(p.document.body.firstChild,0).setCursor();p.removeListener("beforeselectionchange",l);p.removeListener("beforeexeccommand",l);setTimeout(function(){p._selectionChange()},0)}}return function(m){var n=this;n.document.body.innerHTML='<p id="initContent">'+m+"</p>";n.removeListener("beforeselectionchange",l);n.removeListener("beforeexeccommand",l);n.addListener("beforeselectionchange",l);n.addListener("beforeexeccommand",l)}}()};j.inherits(f,d)})();(function(){var a=baidu.editor.dom.domUtils,d=baidu.editor.browser,h=baidu.editor.dom.dtd,c=baidu.editor.utils,b=0,g=a.keys,e={B:"strong",I:"em",FONT:"span"},f=[0,10,12,16,18,24,32,48];baidu.editor.plugins.keystrokes=function(){var i=this;i.addListener("keydown",function(o,r){var t=r.keyCode||r.which;if(t==8||t==46){var n=i.selection.getRange(),q,k,m;if(n.collapsed&&n.startContainer.nodeType==3&&n.startContainer.nodeValue.replace(new RegExp(a.fillChar,"g"),"").length==0){n.setStartBefore(n.startContainer).collapse(true)}if(k=n.getClosedNode()){i.undoManger&&i.undoManger.save();n.setStartBefore(k);a.remove(k);n.setCursor();i.undoManger&&i.undoManger.save();r.preventDefault?r.preventDefault():(r.returnValue=false);return}if(!d.ie){k=a.findParentByTagName(n.startContainer,"table",true);m=a.findParentByTagName(n.endContainer,"table",true);if(k&&!m||!k&&m||k!==m){r.preventDefault();return}if(d.webkit&&n.collapsed&&k){q=n.cloneRange().txtToElmBoundary();k=q.startContainer;if(a.isBlockElm(k)&&k.nodeType==1&&!h.$tableContent[k.tagName]&&!a.getChildCount(k,function(p){return p.nodeType==1?p.tagName!=="BR":1})){q.setStartBefore(k).setCursor();a.remove(k,true);r.preventDefault();return}}}if(n.collapsed&&!n.startOffset){var s=a.findParentByTagName(n.startContainer,"li",true),l;q=n.cloneRange().trimBoundary();if(!q.startOffset){if(d.ie){if(s&&(l=s.previousSibling)){if(t==46&&s.childNodes.length){return}i.undoManger&&i.undoManger.save();n.setEnd(l,l.childNodes.length).collapse();while(s.firstChild){l.appendChild(s.firstChild)}a.remove(s);n.select();i.undoManger&&i.undoManger.save();r.returnValue=false;return}if(t==8&&(s&&l||s&&a.getChildCount(s,function(p){return !a.isBr(p)&&!a.isWhitespace(p)}))){r.returnValue=false;return}}if(s&&!s.nextSibling&&!s.previousSibling&&a.getChildCount(s,function(p){return !a.isWhitespace(p)&&!a.isBr(p)})==0){var j=i.document.createElement("p");s.parentNode.parentNode.insertBefore(j,s.parentNode);j.innerHTML=d.ie?"":"<br/>";n.setStart(j,0).setCursor();a.remove(s.parentNode);i.undoManger&&i.undoManger.save();r.preventDefault?r.preventDefault():(r.returnValue=false)}}}if(i.undoManger){if(!n.collapsed){i.undoManger.save();b=1}}}});i.addListener("keyup",function(s,v){var x=v.keyCode||v.which;if(!d.gecko&&!g[x]&&!v.ctrlKey&&!v.metaKey&&!v.shiftKey&&!v.altKey){q=i.selection.getRange();if(q.collapsed){var l=q.startContainer,k,m=0;while(!a.isBlockElm(l)){if(l.nodeType==1&&c.indexOf(["FONT","B","I"],l.tagName)!=-1){var n=i.document.createElement(e[l.tagName]);if(l.tagName=="FONT"){n.style.cssText=(l.getAttribute("size")?"font-size:"+(f[l.getAttribute("size")]||12)+"px":"")+";"+(l.getAttribute("color")?"color:"+l.getAttribute("color"):"")+";"+(l.getAttribute("face")?"font-family:"+l.getAttribute("face"):"")+";"+l.style.cssText}while(l.firstChild){n.appendChild(l.firstChild)}l.parentNode.insertBefore(n,l);a.remove(l);if(!m){q.setEnd(n,n.childNodes.length).collapse(true)}l=n;m=1}l=l.parentNode}m&&q.select()}}if(x==8||x==46){var q,r,l,u,p=this.currentSelectedArr;if(p&&p.length>0){for(var o=0,j;j=p[o++];){j.innerHTML=d.ie?(d.version<9?"&#65279":""):"<br/>"}q=new baidu.editor.dom.Range(this.document);q.setStart(p[0],0).setCursor();if(b){i.undoManger.save();b=0}if(d.webkit){v.preventDefault()}return}q=i.selection.getRange();if(a.isBody(q.startContainer)&&!q.startOffset){r=i.document.body;if(r.childNodes.length==1&&r.firstChild.nodeType==1&&r.firstChild.tagName.toLowerCase()=="br"&&i.options.enterTag=="p"||i.body.innerHTML==""){i.document.execCommand("formatBlock",false,"<p>");if(d.gecko){q=i.selection.getRange();l=a.findParentByTagName(q.startContainer,"p",true);l&&a.removeDirtyAttr(l);q.setStart(l,0).setCursor()}i.undoManger.save();return}}l=q.startContainer;while(l.nodeType==1&&h.$removeEmpty[l.tagName]){if(a.getChildCount(l,function(y){return y.nodeType!=1||y.tagName.toLowerCase()!="br"})>0){break}u=l.parentNode;a.remove(l);l=u}if(l.nodeType==1&&l.childNodes.length==0){if(d.ie){var t=q.document.createElement("span");l.appendChild(t);q.setStart(t,0).setCursor()}else{var w=q.document.createElement("br");l.appendChild(w);q.setStart(l,0).setCursor()}setTimeout(function(){if(d.ie){a.remove(t)}if(b){i.undoManger.save();b=0}},0)}else{if(b){i.undoManger.save();b=0}}}})}})();(function(){var e={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},a=baidu.editor.dom.domUtils,d=function(g,f){var h=g.selection.getStart();return a.findParentByTagName(h,f,true)},b=0;for(var c in e){(function(g,f){baidu.editor.commands[g]={execCommand:function(j){var h=new baidu.editor.dom.Range(this.document),p="",n=this;if(!b){this.addListener("beforegetcontent",function(){a.clearReduent(n.document,["strong","u","em","sup","sub","strike"])});b=1}if(n.currentSelectedArr&&n.currentSelectedArr.length>0){for(var l=0,k;k=n.currentSelectedArr[l++];){if(k.style.display!="none"){h.selectNodeContents(k).select();!p&&(p=d(this,f));if(j=="superscript"||j=="subscript"){if(!p||p.tagName.toLowerCase()!=j){h.removeInlineStyle(["sub","sup"])}}p?h.removeInlineStyle(f):h.applyInlineStyle(f[0])}}h.selectNodeContents(n.currentSelectedArr[0]).select()}else{h=n.selection.getRange();p=d(this,f);if(h.collapsed){if(p){var o=n.document.createTextNode("");h.insertNode(o).removeInlineStyle(f);h.setStartBefore(o);a.remove(o)}else{var m=h.document.createElement(f[0]);if(j=="superscript"||j=="subscript"){o=n.document.createTextNode("");h.insertNode(o).removeInlineStyle(["sub","sup"]).setStartBefore(o).collapse(true)}h.insertNode(m).setStart(m,0)}h.collapse(true)}else{if(j=="superscript"||j=="subscript"){if(!p||p.tagName.toLowerCase()!=j){h.removeInlineStyle(["sub","sup"])}}p?h.removeInlineStyle(f):h.applyInlineStyle(f[0])}h.select()}return true},queryCommandState:function(){return d(this,f)?1:0}}})(c,e[c])}})();(function(){var a=baidu.editor.dom.domUtils;baidu.editor.commands.anchor={execCommand:function(f,e){var c=this.selection.getRange();var b=c.getClosedNode();if(b&&b.getAttribute("anchorname")){if(e){b.setAttribute("anchorname",e)}else{c.setStartBefore(b).setCursor();a.remove(b)}}else{if(e){var d=this.document.createElement("img");c.collapse(true);d.setAttribute("anchorname",e);d.className="anchorclass";c.insertNode(d).setStartAfter(d).collapse(true).select(true);baidu.editor.browser.gecko&&d.parentNode.insertBefore(this.document.createElement("br"),d.nextSibling)}}}}})();(function(){var a=baidu.editor.dom.domUtils,b=baidu.editor.browser;baidu.editor.commands["delete"]={execCommand:function(f,c){var i=this.selection.getRange(),h=0,k=0,j=this;while(!i.startOffset&&!a.isBody(i.startContainer)&&!a.isBlockElm(i.startContainer)){h=1;i.setStartBefore(i.startContainer)}while(!a.isBody(i.endContainer)&&!a.isBlockElm(i.endContainer)&&i.endOffset==(i.endContainer.nodeType==1?i.endContainer.childNodes.length:i.endContainer.nodeValue.length)){k=1;i.setEndAfter(i.endContainer);if(b.webkit){var e=i.endContainer.childNodes[i.endOffset];if(e&&e.nodeType==1&&e.tagName=="BR"&&i.endContainer.lastChild===e){i.setEndAfter(e)}}}if(h){var d=j.document.createElement("span");d.innerHTML="start";d.id="_baidu_cut_start";i.insertNode(d).setStartBefore(d)}if(k){var g=j.document.createElement("span");g.innerHTML="end";g.id="_baidu_cut_end";i.cloneRange().collapse(false).insertNode(g);i.setEndAfter(g)}i.deleteContents().select()},queryCommandState:function(){return this.selection.getRange().collapsed?-1:0}}})();(function(){var a=baidu.editor.dom.domUtils;baidu.editor.commands.outdent=baidu.editor.commands.indent={execCommand:function(d){var b=this,c=d.toLowerCase()=="outdent"?"0em":(b.options.indentValue||"2em");b.execCommand("Paragraph","p",{textIndent:c})}}})();(function(){var a=baidu.editor.dom.domUtils,b=baidu.editor.dom.dtd,c=function(e){var d=e.selection.getStart();return a.findParentByTagName(d,"blockquote",true)};baidu.editor.commands.blockquote={execCommand:function(o,s){var r=this.selection.getRange(),q=c(this),e=b.blockquote,n=r.createBookmark(),v=this.currentSelectedArr;if(q){if(v&&v.length){a.remove(q,true)}else{var l=r.startContainer,m=a.isBlockElm(l)?l:a.findParent(l,function(i){return a.isBlockElm(i)}),g=r.endContainer,h=a.isBlockElm(g)?g:a.findParent(g,function(i){return a.isBlockElm(i)});if(m.tagName=="LI"||m.tagName=="TD"||m===q){a.remove(q,true)}else{a.breakParent(m,q)}if(m!==h){q=a.findParentByTagName(h,"blockquote");if(q){if(h.tagName=="LI"||h.tagName=="TD"){a.remove(q,true)}else{a.breakParent(h,q)}}}var k=a.getElementsByTagName(this.document,"blockquote");for(var w=0,f;f=k[w++];){if(!f.childNodes.length){a.remove(f)}else{if(a.getPosition(f,m)&a.POSITION_FOLLOWING&&a.getPosition(f,h)&a.POSITION_PRECEDING){a.remove(f,true)}}}}}else{var x=r.cloneRange(),t=x.startContainer.nodeType==1?x.startContainer:x.startContainer.parentNode,d=t,u=1;while(1){if(a.isBody(t)){if(d!==t){if(r.collapsed){x.selectNode(d);u=0}else{x.setStartBefore(d)}}else{x.setStart(t,0)}break}if(!e[t.tagName]){if(r.collapsed){x.selectNode(d)}else{x.setStartBefore(d)}break}d=t;t=t.parentNode}if(u){d=t=t=x.endContainer.nodeType==1?x.endContainer:x.endContainer.parentNode;while(1){if(a.isBody(t)){if(d!==t){x.setEndAfter(d)}else{x.setEnd(t,t.childNodes.length)}break}if(!e[t.tagName]){x.setEndAfter(d);break}d=t;t=t.parentNode}}t=r.document.createElement("blockquote");a.setAttributes(t,s);t.appendChild(x.extractContents());x.insertNode(t);var j=a.getElementsByTagName(t,"blockquote");for(var w=0,p;p=j[w++];){if(p.parentNode){a.remove(p,true)}}}r.moveToBookmark(n).select()},queryCommandState:function(){return c(this)?1:0}}})();(function(){var a=baidu.editor.dom.domUtils;baidu.editor.commands.rowspacing={execCommand:function(b,c){this.execCommand("paragraph","p",{padding:c+"px 0"});return true},queryCommandValue:function(){var c=this.selection.getStart(),b=a.findParent(c,function(e){return a.isBlockElm(e)},true),d;if(b){d=a.getComputedStyle(b,"padding-top").replace(/[^\d]/g,"");return d*1<=10?0:d}return 0}}})();(function(){function a(b,c){b.setStart(c,0).setCursor()}baidu.editor.commands.cleardoc={execCommand:function(e){var f=this,c=f.options.enterTag,d=baidu.editor.browser,b=this.selection.getRange();if(c=="br"){this.body.innerHTML="<br/>";a(b,this.body)}else{this.body.innerHTML="<p>"+(d.ie?"":"<br/>")+"</p>";f.focus();a(b,f.body.firstChild)}}}})();(function(){var a=baidu.editor.dom.domUtils,d=a.isBlockElm,c=function(j){var f=j.selection.getStart(),e;if(f){e=a.findParents(f,true,d,true);for(var h=0,g;g=e[h++];){if(g.getAttribute("dir")){return g}}}},b=function(i,j,h){var m,q=function(p){return p.nodeType==1?!a.isBookmarkNode(p):!a.isWhitespace(p)},g=c(j);if(g&&i.collapsed){g.setAttribute("dir",h);return i}m=i.createBookmark();i.enlarge(true);var r=i.createBookmark(),l=a.getNextDomNode(r.start,false,q),n=i.cloneRange(),f;while(l&&!(a.getPosition(l,r.end)&a.POSITION_FOLLOWING)){if(l.nodeType==3||!d(l)){n.setStartBefore(l);while(l&&l!==r.end&&!d(l)){f=l;l=a.getNextDomNode(l,false,null,function(p){return !d(p)})}n.setEndAfter(f);var k=n.getCommonAncestor();if(!a.isBody(k)&&d(k)){k.setAttribute("dir",h);l=k}else{var e=i.document.createElement("p");e.setAttribute("dir",h);var o=n.extractContents();e.appendChild(o);n.insertNode(e);l=e}l=a.getNextDomNode(l,false,q)}else{l=a.getNextDomNode(l,true,q)}}return i.moveToBookmark(r).moveToBookmark(m)};baidu.editor.commands.directionality={execCommand:function(h,g){var f=new baidu.editor.dom.Range(this.document);if(this.currentSelectedArr&&this.currentSelectedArr.length>0){for(var j=0,k;k=this.currentSelectedArr[j++];){if(k.style.display!="none"){b(f.selectNode(k),this,g)}}f.selectNode(this.currentSelectedArr[0]).select()}else{f=this.selection.getRange();if(f.collapsed){var e=this.document.createTextNode("d");f.insertNode(e)}b(f,this,g);if(e){f.setStartBefore(e).collapse(true);a.remove(e)}f.select()}return true},queryCommandValue:function(){var e=c(this);return e?e.getAttribute("dir"):"ltr"}}})();(function(){var b=baidu.editor.dom.domUtils,d,a,c=baidu.editor.dom.dtd;baidu.editor.commands.elementpath={execCommand:function(p,f){var n=this,h=a[f],m=n.selection.getRange();n.currentSelectedArr&&b.clearSelectedArr(n.currentSelectedArr);d=f*1;if(c.$tableContent[h.tagName]){switch(h.tagName){case"TD":n.currentSelectedArr=[h];h.className=n.options.selectedTdClass;break;case"TR":var q=h.cells;for(var l=0,g;g=q[l++];){n.currentSelectedArr.push(g);g.className=n.options.selectedTdClass}break;case"TABLE":case"TBODY":var r=h.rows;for(var l=0,o;o=r[l++];){q=o.cells;for(var k=0,e;e=q[k++];){n.currentSelectedArr.push(e);e.className=n.options.selectedTdClass}}}h=n.currentSelectedArr[0];if(b.isEmptyNode(h)){m.setStart(h,0).setCursor()}else{m.selectNodeContents(h).select()}}else{m.selectNode(h).select()}},queryCommandValue:function(){var k=this.selection.getStart(),f=b.findParents(k,true),j=[];a=f;for(var h=0,g;g=f[h];h++){var e=g.tagName.toLowerCase();if(e=="img"&&g.getAttribute("anchorname")){e="anchor"}j[h]=e;if(d==h){d=-1;break}}return j}}})();(function(){var a=baidu.editor.dom.domUtils,f={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration"},d=new RegExp(a.fillChar,"g"),c=baidu.editor.browser,b=0;for(var e in f){(function(h,g){baidu.editor.commands[h]={execCommand:function(k,p){p=p||(this.queryCommandState(k)?"none":k=="underline"?"underline":"line-through");var o=this,j=this.selection.getRange(),q;if(!b){o.addListener("beforegetcontent",function(){a.clearReduent(o.document,["span"])});b=1}if(p=="default"){if(j.collapsed){q=o.document.createTextNode("font");j.insertNode(q).select()}o.execCommand("removeFormat","span,a",g);if(q){j.setStartBefore(q).setCursor();a.remove(q)}}else{if(o.currentSelectedArr&&o.currentSelectedArr.length>0){for(var m=0,l;l=o.currentSelectedArr[m++];){j.selectNodeContents(l);j.applyInlineStyle("span",{style:g+":"+p})}j.selectNodeContents(this.currentSelectedArr[0]).select()}else{if(!j.collapsed){if((h=="underline"||h=="strikethrough")&&o.queryCommandValue(h)){o.execCommand("removeFormat","span,a",g)}j=o.selection.getRange();j.applyInlineStyle("span",{style:g+":"+p}).select()}else{var n=a.findParentByTagName(j.startContainer,"span",true);q=o.document.createTextNode("font");if(n&&!n.children.length&&!n[c.ie?"innerText":"textContent"].replace(d,"").length){j.insertNode(q);if(h=="underline"||h=="strikethrough"){j.selectNode(q).select();o.execCommand("removeFormat","span,a",g,null);n=a.findParentByTagName(q,"span",true);j.setStartBefore(q)}n.style.cssText=n.style.cssText+";"+g+":"+p;j.collapse(true).select()}else{j.insertNode(q);j.selectNode(q).select();n=j.document.createElement("span");if(h=="underline"||h=="strikethrough"){o.execCommand("removeFormat","span,a",g)}n.style.cssText=g+":"+p;q.parentNode.insertBefore(n,q);j.setStart(n,0).setCursor()}a.remove(q)}}}return true},queryCommandValue:function(j){var i=this.selection.getStart();if(j=="underline"||j=="strikethrough"){var k=i,l;while(k&&!a.isBlockElm(k)&&!a.isBody(k)){l=a.getComputedStyle(k,g);if(l!="none"){return l}k=k.parentNode}return"none"}return a.getComputedStyle(i,g)},queryCommandState:function(i){if(!(i=="underline"||i=="strikethrough")){return 0}return this.queryCommandValue(i)==(i=="underline"?"underline":"line-through")}}})(e,f[e])}})();(function(){var a=baidu.editor.dom.domUtils,c=baidu.editor.dom.dtd,b=baidu.editor.utils;baidu.editor.commands.inserthtml={execCommand:function(h,n){var p=this,o,r,l,t,e,k=p.currentSelectedArr;o=p.selection.getRange();e=o.document.createElement("div");e.style.display="inline";e.innerHTML=b.trim(n);p.adjustTable&&p.adjustTable(e);if(k&&k.length){for(var l=0,d;d=k[l++];){d.className=""}k[0].innerHTML="";o.setStart(k[0],0).collapse(true);p.currentSelectedArr=[]}if(!o.collapsed){o.deleteContents();if(o.startContainer.nodeType==1){var f=o.startContainer.childNodes[o.startOffset],g;if(f&&a.isBlockElm(f)&&(g=f.previousSibling)&&a.isBlockElm(g)){o.setEnd(g,g.childNodes.length).collapse();while(f.firstChild){g.appendChild(f.firstChild)}a.remove(f)}}}var f,s,g,j,q=0;while(f=e.firstChild){o.insertNode(f);if(!q&&f.nodeType==a.NODE_ELEMENT&&a.isBlockElm(f)){s=a.findParent(f,function(i){return a.isBlockElm(i)});if(s&&s.tagName.toLowerCase!="body"&&!(c[s.tagName][f.nodeName]&&f.parentNode===s)){if(!c[s.tagName][f.nodeName]){g=s}else{j=f.parentNode;while(j!==s){g=j;j=j.parentNode}}a.breakParent(f,g||j);var g=f.previousSibling;a.trimWhiteTextNode(g);if(!g.childNodes.length){a.remove(g)}q=1}}var m=f.nextSibling;if(!e.firstChild&&m&&a.isBlockElm(m)){o.setStart(m,0).collapse(true);break}o.setEndAfter(f).collapse()}f=o.startContainer;if(a.isBlockElm(f)&&a.isEmptyNode(f)){f.innerHTML=baidu.editor.browser.ie?"":"<br/>"}o.select(true)}}}());(function(){var a=baidu.editor.dom.domUtils;baidu.editor.commands.horizontal={execCommand:function(c){if(this.queryCommandState(c)!==-1){this.execCommand("insertHtml","<hr>");var b=this.selection.getRange(),e=b.startContainer;if(e.nodeType==1&&!e.childNodes[b.startOffset]){var d;if(d=e.childNodes[b.startOffset-1]){if(d.nodeType==1&&d.tagName=="HR"){if(this.options.enterTag=="p"){d=this.document.createElement("p");b.insertNode(d);b.setStart(d,0).setCursor()}else{d=this.document.createElement("br");b.insertNode(d);b.setStartBefore(d).setCursor()}}}}return true}},queryCommandState:function(){var b=this.selection.getRange();return a.findParentByTagName(b.startContainer,"table")||a.findParentByTagName(b.endContainer,"table")?-1:0}}})();(function(){var b=baidu.editor.dom.domUtils,e=b.isBlockElm,d={left:1,right:1,center:1,justify:1},c=baidu.editor.utils,a=function(i,f){var l=i.createBookmark(),q=function(p){return p.nodeType==1?p.tagName.toLowerCase()!="br"&&!b.isBookmarkNode(p):!b.isWhitespace(p)};i.enlarge(true);var r=i.createBookmark(),k=b.getNextDomNode(r.start,false,q),n=i.cloneRange(),h;while(k&&!(b.getPosition(k,r.end)&b.POSITION_FOLLOWING)){if(k.nodeType==3||!e(k)){n.setStartBefore(k);while(k&&k!==r.end&&!e(k)){h=k;k=b.getNextDomNode(k,false,null,function(p){return !e(p)})}n.setEndAfter(h);var j=n.getCommonAncestor();if(!b.isBody(j)&&e(j)){if(!c.isString(f)){for(var m in f){j.style[m]=f[m]}}else{j.style.textAlign=f}k=j}else{var g=i.document.createElement("p");if(!c.isString(f)){for(var m in f){g.style[m]=f[m]}}else{g.style.textAlign=f}var o=n.extractContents();g.appendChild(o);n.insertNode(g);k=g}k=b.getNextDomNode(k,false,q)}else{k=b.getNextDomNode(k,true,q)}}return i.moveToBookmark(r).moveToBookmark(l)};baidu.editor.commands.justify={execCommand:function(h,l){var g=new baidu.editor.dom.Range(this.document);if(this.currentSelectedArr&&this.currentSelectedArr.length>0){for(var j=0,k;k=this.currentSelectedArr[j++];){a(g.selectNode(k),l)}g.selectNode(this.currentSelectedArr[0]).select()}else{g=this.selection.getRange();if(g.collapsed){var f=this.document.createTextNode("p");g.insertNode(f)}a(g,l);if(f){g.setStartBefore(f).collapse(true);b.remove(f)}g.select()}return true},queryCommandValue:function(){var f=this.selection.getStart(),g=b.getComputedStyle(f,"text-align");return d[g]?g:"left"}}})();(function(){var d=baidu.editor.dom,a=d.domUtils,b=baidu.editor.browser;function c(g){var h=g.startContainer,f=g.endContainer;if(h=a.findParentByTagName(h,"a",true)){g.setStartBefore(h)}if(f=a.findParentByTagName(f,"a",true)){g.setEndAfter(f)}}baidu.editor.commands.unlink={execCommand:function(){var f,g=new baidu.editor.dom.Range(this.document),n=this.currentSelectedArr,m;if(n&&n.length>0){for(var k=0,l;l=n[k++];){f=a.getElementsByTagName(l,"a");for(var h=0,o;o=f[h++];){a.remove(o,true)}}if(a.isEmptyNode(n[0])){g.setStart(n[0],0).setCursor()}else{g.selectNodeContents(n[0]).select()}}else{g=this.selection.getRange();if(g.collapsed&&!a.findParentByTagName(g.startContainer,"a",true)){return}m=g.createBookmark();c(g);g.removeInlineStyle("a").moveToBookmark(m).select()}},queryCommandState:function(){return this.queryCommandValue("link")?0:-1}};function e(g,h){c(g=g.adjustmentBoundary());var i=g.startContainer;if(i.nodeType==1){i=i.childNodes[g.startOffset];if(i&&i.nodeType==1&&i.tagName=="A"&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(i[b.ie?"innerText":"textContent"])){i.innerHTML=h.href}}g.removeInlineStyle("a");if(g.collapsed){var f=g.document.createElement("a");a.setAttributes(f,h);f.innerHTML=h.href;g.insertNode(f).selectNode(f)}else{g.applyInlineStyle("a",h)}}baidu.editor.commands.link={execCommand:function(g,j){var f=new baidu.editor.dom.Range(this.document),l=this.currentSelectedArr;if(l&&l.length){for(var h=0,k;k=l[h++];){if(a.isEmptyNode(k)){k.innerHTML=j.href}e(f.selectNodeContents(k),j)}if(a.isEmptyNode(l[0])){f.setStart(l[0],0).setCursor()}else{f.selectNodeContents(l[0]).select()}}else{e(f=this.selection.getRange(),j);f.collapse().select()}},queryCommandValue:function(){var o=new baidu.editor.dom.Range(this.document),m=this.currentSelectedArr,k,j;if(m&&m.length){for(var n=0,g;g=m[n++];){k=g.getElementsByTagName("a");if(k[0]){return k[0]}}}else{o=this.selection.getRange();if(o.collapsed){j=this.selection.getStart();if(j&&(j=a.findParentByTagName(j,"a",true))){return j}}else{var h=o.startContainer.nodeType==3||!o.startContainer.childNodes[o.startOffset]?o.startContainer:o.startContainer.childNodes[o.startOffset],l=o.endContainer.nodeType==3||o.endOffset==0?o.endContainer:o.endContainer.childNodes[o.endOffset-1],p=o.getCommonAncestor();j=a.findParentByTagName(p,"a",true);if(!j&&p.nodeType==1){var k=p.getElementsByTagName("a"),f,q;for(var n=0,r;r=k[n++];){f=a.getPosition(r,h),q=a.getPosition(r,l);if((f&a.POSITION_FOLLOWING||f&a.POSITION_CONTAINS)&&(q&a.POSITION_PRECEDING||q&a.POSITION_CONTAINS)){j=r;break}}}return j}}}}})();(function(){var a=baidu.editor.dom.domUtils,c=baidu.editor.browser,b=c.webkit,d=c.gecko;baidu.editor.commands.insertorderedlist=baidu.editor.commands.insertunorderedlist={execCommand:function(j,y){var A=this,o=a.findParentByTagName(this.selection.getStart(),j.toLowerCase()=="insertorderedlist"?"ol":"ul",true),B=this.document,r,v=1;if(c.ie){var l=A.selection.getStart(),g=a.findParent(l,function(h){return h.tagName=="BLOCKQUOTE"}),k=0;if(g){k=1}}y=y&&y.toLowerCase()||(j=="insertorderedlist"?"decimal":"disc");r=A.selection.getRange();if(o&&!r.collapsed){var m=a.findParentByTagName(r.endContainer,j.toLowerCase()=="insertorderedlist"?"ol":"ul",true);if(!m){v=0}}B.execCommand(j,false,null);if(o&&a.getStyle(o,"list-style-type")!=y&&v){B.execCommand(j,false,null)}o=a.findParentByTagName(this.selection.getStart(),j.toLowerCase()=="insertorderedlist"?"ol":"ul",true);if(o){if(b){var e=o.getElementsByTagName("li");if(o.parentNode.tagName.toLowerCase()=="p"){r=this.selection.getRange();var n=r.createBookmark();a.remove(o.parentNode,true);r.moveToBookmark(n).select()}}var s=o.previousSibling;if(s&&s.nodeType==1&&s.tagName==o.tagName&&y==a.getStyle(s,"list-style-type")){r=A.selection.getRange();var n=r.createBookmark();while(o.firstChild){s.appendChild(o.firstChild)}a.remove(o);r.moveToBookmark(n).select();return 1}if(d){o.removeAttribute("_moz_dirty");var t=o.getElementsByTagName("*");for(var w=0,p;p=t[w++];){p.removeAttribute("_moz_dirty")}}o.style.listStyleType=y;if(c.ie&&k&&!a.findParent(o,function(h){return h.tagName=="BLOCKQUOTE"})){var u=a.findParent(o,function(h){return h.tagName==j.toLowerCase()=="insertorderedlist"?"OL":"UL"});if(u){g.innerHTML="";while(u.firstChild){g.appendChild(u.firstChild)}u.parentNode.insertBefore(g,u);a.remove(u)}}if(c.webkit){var x=a.findParentByTagName(o,["h1","h2","h3","h4","h5","h6"]);if(x){r=A.selection.getRange();var f=r.createBookmark(),e=a.getElementsByTagName(o,"li");for(var w=0,q;q=e[w++];){var z=x.cloneNode(false);while(q.firstChild){z.appendChild(q.firstChild)}q.appendChild(z)}a.remove(x,true);r.moveToBookmark(f).select()}}}},queryCommandState:function(f){var e=this.selection.getStart();return a.findParentByTagName(e,f.toLowerCase()=="insertorderedlist"?"ol":"ul",true)?1:0},queryCommandValue:function(g){var e=this.selection.getStart(),f=a.findParentByTagName(e,g.toLowerCase()=="insertorderedlist"?"ol":"ul",true);return f?a.getStyle(f,"list-style-type"):null}}})();(function(){var a=baidu.editor.dom.domUtils,f=a.isBlockElm,e=["TD","LI","PRE"],b=baidu.editor.utils,c=baidu.editor.browser,d=function(i,g,o){var k=i.createBookmark(),p=function(s){return s.nodeType==1?s.tagName.toLowerCase()!="br"&&!a.isBookmarkNode(s):!a.isWhitespace(s)},r;i.enlarge(true);var q=i.createBookmark(),j=a.getNextDomNode(q.start,false,p),n=i.cloneRange(),h;while(j&&!(a.getPosition(j,q.end)&a.POSITION_FOLLOWING)){if(j.nodeType==3||!f(j)){n.setStartBefore(j);while(j&&j!==q.end&&!f(j)){h=j;j=a.getNextDomNode(j,false,null,function(s){return !f(s)})}n.setEndAfter(h);r=i.document.createElement(g);if(o){for(var m in o){r.style[m]=o[m]}}r.appendChild(n.extractContents());n.insertNode(r);var l=r.parentNode;if(f(l)&&!a.isBody(r.parentNode)&&b.indexOf(e,l.tagName)==-1){l.getAttribute("dir")&&r.setAttribute("dir",l.getAttribute("dir"));l.style.cssText&&(r.style.cssText=l.style.cssText+";"+r.style.cssText);l.style.textAlign&&!r.style.textAlign&&(r.style.textAlign=l.style.textAlign);l.style.textIndent&&!r.style.textIndent&&(r.style.textIndent=l.style.textIndent);l.style.padding&&!r.style.padding&&(r.style.padding=l.style.padding);if(o&&/h\d/i.test(l.tagName)){for(var m in o){l.style[m]=o[m]}a.remove(r,true);r=l}else{a.remove(r.parentNode,true)}}if(b.indexOf(e,l.tagName)!=-1){j=l}else{j=r}j=a.getNextDomNode(j,false,p)}else{j=a.getNextDomNode(j,true,p)}}return i.moveToBookmark(q).moveToBookmark(k)};baidu.editor.commands.paragraph={execCommand:function(q,g,p){var n=new baidu.editor.dom.Range(this.document);if(this.currentSelectedArr&&this.currentSelectedArr.length>0){for(var m=0,h;h=this.currentSelectedArr[m++];){if(h.style.display=="none"){continue}if(!a.getChildCount(h,function(i){return !a.isBr(i)&&!a.isWhitespace(i)})){var k=this.document.createTextNode("paragraph");h.insertBefore(k,h.firstChild)}d(n.selectNodeContents(h),g,p);var o=k.parentNode;a.remove(k);if(c.ie&&!o.firstChild){o.innerHTML="&nbsp;"}}n.selectNode(this.currentSelectedArr[0]).select()}else{n=this.selection.getRange();if(n.collapsed){var l=this.document.createTextNode("p");n.insertNode(l)}n=d(n,g,p);if(l){n.setStartBefore(l).collapse(true);a.remove(l)}if(c.gecko&&n.collapsed&&n.startContainer.nodeType==1){var j=n.startContainer.childNodes[n.startOffset];if(j&&j.nodeType==1&&j.tagName.toLowerCase()==g){n.setStart(j,0).collapse(true)}}n.select()}return true},queryCommandValue:function(){var g=this.selection.getStart(),h=a.findParentByTagName(g,["p","h1","h2","h3","h4","h5","h6"],true);return h&&h.tagName.toLowerCase()}}})();baidu.editor.commands.preview={execCommand:function(){var b=this;var a=window.open("","_blank","");var c=a.document;c.open();c.write("<html><head><title></title></head><body>"+b.getContent()+"</body></html>");c.close()},notNeedUndo:1};(function(){baidu.editor.commands.print={execCommand:function(){this.window.print()},notNeedUndo:1}})();(function(){var a=baidu.editor.dom.domUtils,b=baidu.editor.dom.dtd;baidu.editor.commands.removeformat={execCommand:function(o,r,c,m,n){var h=new RegExp("^(?:"+(r||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),f=c?[]:(m||this.options.removeFormatAttributes).split(","),j=new baidu.editor.dom.Range(this.document),k,e,l,d=function(i){return i.nodeType==1};function p(x){var i=x.createBookmark();if(x.collapsed){x.enlarge(true)}if(!n){var s=a.findParentByTagName(x.startContainer,"a",true);if(s){x.setStartBefore(s)}s=a.findParentByTagName(x.endContainer,"a",true);if(s){x.setEndAfter(s)}}k=x.createBookmark();t=k.start;while((l=t.parentNode)&&!a.isBlockElm(l)){a.breakParent(t,l);a.clearEmptySibling(t)}if(k.end){t=k.end;while((l=t.parentNode)&&!a.isBlockElm(l)){a.breakParent(t,l);a.clearEmptySibling(t)}var y=a.getNextDomNode(k.start,false,d),w;while(y){if(y==k.end){break}w=a.getNextDomNode(y,true,d);if(!b.$empty[y.tagName.toLowerCase()]&&!a.isBookmarkNode(y)){if(h.test(y.tagName)){if(c){a.removeStyle(y,c);if(a.isRedundantSpan(y)&&c!="text-decoration"){a.remove(y,true)}}else{y.tagName!="A"&&a.remove(y,true)}}else{if(!b.$tableContent[y.tagName]){a.removeAttributes(y,f);if(a.isRedundantSpan(y)){a.remove(y,true)}}}}y=w}}var z=k.start.parentNode;if(a.isBlockElm(z)&&!b.$tableContent[z.tagName]){a.removeAttributes(z,f)}z=k.end.parentNode;if(k.end&&a.isBlockElm(z)&&!b.$tableContent[z.tagName]){a.removeAttributes(z,f)}x.moveToBookmark(k).moveToBookmark(i);var t=x.startContainer,v,u=x.collapsed;while(t.nodeType==1&&t.childNodes.length==0&&b.$removeEmpty[t.tagName]){v=t.parentNode;x.setStartBefore(t);if(x.startContainer===x.endContainer){x.endOffset--}a.remove(t);t=v}if(!u){t=x.endContainer;while(t.nodeType==1&&t.childNodes.length==0&&b.$removeEmpty[t.tagName]){v=t.parentNode;x.setEndBefore(t);a.remove(t);t=v}}}if(this.currentSelectedArr&&this.currentSelectedArr.length){for(var g=0,q;q=this.currentSelectedArr[g++];){j.selectNodeContents(q);p(j)}j.selectNodeContents(this.currentSelectedArr[0]).select()}else{j=this.selection.getRange();p(j);j.select()}}}})();(function(){var a=baidu.editor.dom.domUtils,e=[],c,b=0,d=baidu.editor.browser;baidu.editor.commands.formatmatch={execCommand:function(g){var k=this;if(b){b=0;e=[];k.removeListener("mouseup",m);return}function m(s,u){if(d.webkit){var r=u.target.tagName=="IMG"?u.target:null}function n(i){if(v&&(!k.currentSelectedArr||!k.currentSelectedArr.length)){i.selectNode(v)}return i.applyInlineStyle(e[e.length-1].tagName,null,e)}k.undoManger&&k.undoManger.save();var q=k.selection.getRange(),t=r||q.getClosedNode();if(c&&t&&t.tagName=="IMG"){t.style.cssText+=";float:"+(c.style.cssFloat||c.style.styleFloat||"none")+";display:"+(c.style.display||"inline");c=null}else{if(!c){var o=q.collapsed;if(o){var v=k.document.createTextNode("match");q.insertNode(v).select()}k.__hasEnterExecCommand=true;k.execCommand("removeformat",null,null,null,o);k.__hasEnterExecCommand=false;q=k.selection.getRange();if(e.length==0){if(k.currentSelectedArr&&k.currentSelectedArr.length>0){q.selectNodeContents(k.currentSelectedArr[0]).select()}}else{if(k.currentSelectedArr&&k.currentSelectedArr.length>0){for(var p=0,w;w=k.currentSelectedArr[p++];){q.selectNodeContents(w);n(q)}q.selectNodeContents(k.currentSelectedArr[0]).select()}else{n(q)}}if(!k.currentSelectedArr||!k.currentSelectedArr.length){if(v){q.setStartBefore(v).collapse(true)}q.select()}v&&a.remove(v)}}k.undoManger&&k.undoManger.save();k.removeListener("mouseup",m);b=0}var f=k.selection.getRange();c=f.getClosedNode();if(!c||c.tagName!="IMG"){f.collapse(true).shrinkBoundary();var l=f.startContainer;e=a.findParents(l,true,function(i){return !a.isBlockElm(i)&&i.nodeType==1});for(var j=0,h;h=e[j];j++){if(h.tagName=="A"){e.splice(j,1);break}}}k.addListener("mouseup",m);b=1},queryCommandState:function(){return b},notNeedUndo:1}})();(function(){baidu.editor.commands.searchreplace={execCommand:function(m,a){var h=this,b=h.selection,e,g,d=0,f=h.currentRangeForSR,c=h.firstForSR;a=baidu.editor.utils.extend(a,{replaceStr:null,all:false,casesensitive:false,dir:1},true);if(baidu.editor.browser.ie){while(1){var j;g=h.document.selection.createRange();j=g.duplicate();j.moveToElementText(h.document.body);if(a.all){c=0;a.dir=1;if(f){j.setEndPoint(a.dir==-1?"EndToStart":"StartToEnd",f)}}else{j.setEndPoint(a.dir==-1?"EndToStart":"StartToEnd",g);if(a.replaceStr){j.setEndPoint(a.dir==-1?"StartToEnd":"EndToStart",g)}}g=j.duplicate();if(!j.findText(a.searchStr,a.dir,a.casesensitive?4:0)){j=h.document.selection.createRange();j.scrollIntoView();return d}j.select();if(a.replaceStr){e=b.getRange();e.deleteContents().insertNode(e.document.createTextNode(a.replaceStr)).select();f=b.getNative().createRange()}d++;if(!a.all){break}}}else{var i=h.window,l=b.getNative(),j;while(1){if(a.all){if(f){f.collapse(false);g=f}else{g=h.document.createRange();g.setStart(h.document.body,0)}l.removeAllRanges();l.addRange(g);c=0;a.dir=1}else{g=i.getSelection().getRangeAt(0);if(a.replaceStr){g.collapse(a.dir==1?true:false)}}if(!c){g.collapse(a.dir<0?true:false);l.removeAllRanges();l.addRange(g)}else{l.removeAllRanges()}if(!i.find(a.searchStr,a.casesensitive,a.dir<0?true:false)){l.removeAllRanges();return d}c=0;e=i.getSelection().getRangeAt(0);if(!e.collapsed){if(a.replaceStr){e.deleteContents();var k=i.document.createTextNode(a.replaceStr);e.insertNode(k);e.selectNode(k);l.addRange(e);f=e.cloneRange()}}d++;if(!a.all){break}}}return true}}})();(function(){var a=baidu.editor.browser;baidu.editor.commands.selectall={execCommand:function(){this.document.execCommand("selectAll",false,null);!a.ie&&this.focus()},notNeedUndo:1}})();baidu.editor.commands.time={execCommand:function(){var b=new Date,c=b.getMinutes(),d=b.getSeconds(),a=[b.getHours(),c<10?"0"+c:c,d<10?"0"+d:d];this.execCommand("insertHtml",a.join(":"));return true}};baidu.editor.commands.date={execCommand:function(){var c=new Date,d=c.getMonth()+1,b=c.getDate(),a=[c.getFullYear(),d<10?"0"+d:d,b<10?"0"+b:b];this.execCommand("insertHtml",a.join("-"));return true}};(function(){var a=baidu.editor.browser;baidu.editor.plugins.autoheight=function(){var c=this;c.autoHeightEnabled=this.options.autoHeightEnabled;var e;var d;var b;c.enableAutoHeight=function(){var f=c.iframe,h=c.document,g=c.options.minFrameHeight;function i(){c.setHeight(Math.max(a.ie?h.body.scrollHeight:h.body.offsetHeight+20,g))}this.autoHeightEnabled=true;d=f.scroll;b=h.body.style.overflowY;f.scroll="no";h.body.style.overflowY="hidden";e=setTimeout(function(){i();e=setTimeout(arguments.callee)});c.fireEvent("autoheightchanged",this.autoHeightEnabled)};c.disableAutoHeight=function(){var f=c.iframe,g=c.document;f.scroll=d;g.body.style.overflowY=b;clearTimeout(e);this.autoHeightEnabled=false;c.fireEvent("autoheightchanged",this.autoHeightEnabled)};c.addListener("ready",function(){if(this.autoHeightEnabled){c.enableAutoHeight()}})}})();(function(){var c=baidu.editor.browser,a=baidu.editor.dom.domUtils,b;baidu.editor.plugins.enterkey=function(){var f=this,d=f.options.enterTag,e=0,g;f.addListener("keyup",function(s,t){var v=t.keyCode||t.which;if(v==13){var r=f.selection.getRange(),m=r.startContainer,i;if(!c.ie){if(/h\d/i.test(b)){if(c.gecko){var q=a.findParentByTagName(m,["h1","h2","h3","h4","h5","h6","blockquote"],true);if(!q){f.document.execCommand("formatBlock",false,"<p>");i=1}}else{if(m.nodeType==1){var o=f.document.createTextNode(""),k;r.insertNode(o);k=a.findParentByTagName(o,"div");if(k){var l=f.document.createElement("p");while(k.firstChild){l.appendChild(k.firstChild)}k.parentNode.insertBefore(l,k);a.remove(k);r.setStartBefore(o).setCursor();i=1}a.remove(o)}}}}if(f.options.enterTag=="p"&&g&&g.length>0){if(!r.startOffset&&m.nodeType==1&&a.isBlockElm(m)){if(a.isEmptyNode(m)){var u=f.document.createDocumentFragment(),j=u,n;while((n=g.pop())&&n.nodeType==1){j.appendChild(n.cloneNode(false));j=j.firstChild}if(u.firstChild){m.innerHTML="";r.insertNode(u).setStart(j,0).setCursor();i=1}}}}if(f.undoManger&&i){f.undoManger.save()}}});f.addListener("keypress",function(m,o){var q=o.keyCode||o.which;if(q==13){b="";if(!c.webkit&&f.undoManger){f.undoManger.save()}var j=f.selection.getRange();g=[];j.shrinkBoundary();if(j.collapsed){g=a.findParents(j.startContainer,true,function(r){return r.nodeType==1&&!a.isBlockElm(r)&&r.tagName!="A"},true)}if(a.findParentByTagName(j.startContainer,["ol","ul"],true)){return}if(!j.collapsed){var h=j.startContainer,i=j.endContainer,k=a.findParentByTagName(h,"td",true),l=a.findParentByTagName(i,"td",true);if(k&&l&&k!==l||!k&&l||k&&!l){o.preventDefault?o.preventDefault():(o.returnValue=false);return}}f.currentSelectedArr&&a.clearSelectedArr(f.currentSelectedArr);if(d=="p"){if(!c.ie){h=a.findParentByTagName(j.startContainer,["p","h1","h2","h3","h4","h5","h6","blockquote"],true);if(!h){f.document.execCommand("formatBlock",false,"<p>");if(c.gecko){j=f.selection.getRange();h=a.findParentByTagName(j.startContainer,"p",true);h&&a.removeDirtyAttr(h)}}else{b=h.tagName;h.tagName.toLowerCase()=="p"&&c.gecko&&a.removeDirtyAttr(h)}}}else{o.preventDefault?o.preventDefault():(o.returnValue=false);if(!j.collapsed){j.deleteContents();h=j.startContainer;if(h.nodeType==1&&(h=h.childNodes[j.startOffset])){while(h.nodeType==1){if(baidu.editor.dom.dtd.$empty[h.tagName]){j.setStartBefore(h).setCursor();if(f.undoManger){f.undoManger.save()}return false}if(!h.firstChild){var p=j.document.createElement("br");h.appendChild(p);j.setStart(h,0).setCursor();if(f.undoManger){f.undoManger.save()}return false}h=h.firstChild}if(h===j.startContainer.childNodes[j.startOffset]){p=j.document.createElement("br");j.insertNode(p).setCursor()}else{j.setStart(h,0).setCursor()}}else{p=j.document.createElement("br");j.insertNode(p).setStartAfter(p).setCursor()}}else{p=j.document.createElement("br");j.insertNode(p);var n=p.parentNode;if(n.lastChild===p){p.parentNode.insertBefore(p.cloneNode(true),p);j.setStartBefore(p)}else{j.setStartAfter(p)}j.setCursor()}}if(!c.webkit&&f.undoManger){f.undoManger.save()}}})}})();baidu.editor.plugins.fiximgclick=function(){var b=this,a=baidu.editor.browser;if(a.webkit){b.addListener("click",function(d,f){if(f.target.tagName=="IMG"){var c=new baidu.editor.dom.Range(b.document);c.selectNode(f.target).select()}})}};(function(){var a=new RegExp(baidu.editor.dom.domUtils.fillChar+"|</hr>","gi"),b=baidu.editor.browser;baidu.editor.plugins.undo=function(){var h=this,j=h.options.maxUndoCount,g=h.options.maxInputCount,c=/\b(?:href|src|name)="[^"]*?"/gi;function e(){this.list=[];this.index=0;this.hasUndo=false;this.hasRedo=false;this.undo=function(){if(this.hasUndo){var m=this.getScene(),l=this.list[this.index];if(l.content.replace(c,"")!=m.content.replace(c,"")){this.save()}if(!this.list[this.index-1]&&this.list.length==1){this.reset();return}while(this.list[this.index].content==this.list[this.index-1].content){this.index--;if(this.index==0){return this.restore(0)}}this.restore(--this.index)}};this.redo=function(){if(this.hasRedo){while(this.list[this.index].content==this.list[this.index+1].content){this.index++;if(this.index==this.list.length-1){return this.restore(this.index)}}this.restore(++this.index)}};this.restore=function(){var o=this.list[this.index];h.document.body.innerHTML=o.bookcontent.replace(a,"");var l=new baidu.editor.dom.Range(h.document);l.moveToBookmark({start:"_baidu_bookmark_start_",end:"_baidu_bookmark_end_",id:true}).select(!b.gecko);this.update();if(h.currentSelectedArr){h.currentSelectedArr=[];var n=h.document.getElementsByTagName("td");for(var m=0,p;p=n[m++];){if(p.className==h.options.selectedTdClass){h.currentSelectedArr.push(p)}}}this.clearKey()};this.getScene=function(){var m=h.selection.getRange(),l=h.body.innerHTML.replace(a,"");baidu.editor.browser.ie&&(l=l.replace(/>&nbsp;</g,"><").replace(/\s*</g,"").replace(/>\s*/g,">"));var o=m.createBookmark(true,true),n=h.body.innerHTML.replace(a,"");m.moveToBookmark(o).select(true);return{bookcontent:n,content:l}};this.save=function(){var m=this.getScene(),l=this.list[this.index];if(l&&l.content==m.content&&l.bookcontent==m.bookcontent){return}this.list=this.list.slice(0,this.index+1);this.list.push(m);if(this.list.length>j){this.list.shift()}this.index=this.list.length-1;this.clearKey();this.update()};this.update=function(){this.hasRedo=this.list[this.index+1]?true:false;this.hasUndo=this.list[this.index-1]||this.list.length==1?true:false};this.reset=function(){this.list=[];this.index=0;this.hasUndo=false;this.hasRedo=false;this.clearKey()};this.clearKey=function(){f=0;d=null}}h.undoManger=new e();function i(){this.undoManger.save()}h.addListener("beforeexeccommand",i);h.addListener("afterexeccommand",i);h.addListener("reset",function(){h.undoManger.reset()});h.commands.redo=h.commands.undo={execCommand:function(l){h.undoManger[l]()},queryCommandState:function(l){return h.undoManger["has"+(l.toLowerCase()=="undo"?"Undo":"Redo")]?0:-1},notNeedUndo:1};var k={16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},f=0,d;h.addListener("keydown",function(m,l){var n=l.keyCode||l.which;if(!k[n]&&!l.ctrlKey&&!l.metaKey&&!l.shiftKey&&!l.altKey){if(h.undoManger.list.length==0||((n==8||n==46)&&d!=n)){h.undoManger.save();d=n;return}if(h.undoManger.list.length==2&&h.undoManger.index==0&&f==0){h.undoManger.list.splice(1,1);h.undoManger.update()}d=n;f++;if(f>g){setTimeout(function(){h.undoManger.save()},0)}}})}})();(function(){baidu.editor.plugins.serialize=function(){var d=this;var o=baidu.editor.dom.dtd;var g=o.$empty;var t=baidu.editor.browser;var n=function(){var w=/<(?:(?:\/([^>]+)>\s*)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>\s*))/g;var u=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g;var x={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1};var A={script:1,style:1};var v={li:{"$":"ul",ul:1,ol:1},dd:{"$":"dl",dl:1},dt:{"$":"dl",dl:1},option:{"$":"select",select:1},td:{"$":"tr",tr:1},tr:{"$":"tbody",tbody:1,thead:1,tfoot:1,table:1},tbody:{"$":"table",table:1},thead:{"$":"table",table:1},tfoot:{"$":"table",table:1},col:{"$":"colgroup"}};var y={table:"td",tbody:"td",thead:"td",tfoot:"td",tr:"td",colgroup:"col",ul:"li",ol:"li",dl:"dd",select:"option"};function z(E,I){var F,G=0,C,N;w.exec("");while((F=w.exec(E))){var L=F.index;if(L>G){var O=E.slice(G,L);if(N){N.push(O)}else{I.onText(O)}}G=w.lastIndex;if((C=F[1])){C=C.toLowerCase();if(N&&C==N._tag_name){I.onCDATA(N.join(""));N=null}if(!N){I.onTagClose(C);continue}}if(N){N.push(F[0]);continue}if((C=F[3])){if(/="/.test(C)){continue}C=C.toLowerCase();var M=F[4],B,D={},K=M&&M.slice(-1)=="/";if(M){u.exec("");while((B=u.exec(M))){var J=B[1].toLowerCase(),H=B[2]||B[3]||B[4]||"";if(!H&&x[J]){H=J}if(J=="style"){if(t.ie&&t.version<=6){H=H.replace(/(?!;)\s*([\w-]+):/g,function(P,Q){return Q.toLowerCase()+":"})}}D[J]=H}}I.onTagOpen(C,D,K);if(!N&&A[C]){N=[];N._tag_name=C}continue}if((C=F[2])){I.onComment(C)}}if(E.length>G){I.onText(E.slice(G,E.length))}}return function(E,F){var C={type:"fragment",parent:null,children:[]};var D=C;function H(I){I.parent=D;D.children.push(I)}function G(J,I){var K=J;if(v[K.tag]){while(v[D.tag]&&v[D.tag][K.tag]){D=D.parent}if(D.tag==K.tag){D=D.parent}while(v[K.tag]){if(v[K.tag][D.tag]){break}K=K.parent={type:"element",tag:v[K.tag]["$"],attributes:{},children:[K]}}}if(F){while(o[K.tag]&&!(D.tag=="span"?baidu.editor.utils.extend(o.strong,{a:1,A:1}):(o[D.tag]||o.div))[K.tag]){if(B(D)){continue}if(!D.parent){break}D=D.parent}}K.parent=D;D.children.push(K);if(I){D=J}return J}function B(I){var J;if(!I.children.length&&(J=y[I.tag])){G({type:"element",tag:J,attributes:{},children:[]},true);return true}return false}z(E,{onText:function(I){while(!(o[D.tag]||o.div)["#"]){if(B(D)){continue}D=D.parent}if(/\S/.test(I)){H({type:"text",data:I})}},onComment:function(I){H({type:"comment",data:I})},onCDATA:function(I){while(!(o[D.tag]||o.div)["#"]){if(B(D)){continue}D=D.parent}H({type:"cdata",data:I})},onTagOpen:function(I,K,J){J=J||g[I];G({type:"element",tag:I,attributes:K,closed:J,children:[]},!J)},onTagClose:function(I){var J=D;while(J&&I!=J.tag){J=J.parent}if(J){for(var K=D;K!==J.parent;K=K.parent){B(K)}D=J.parent}else{J={type:"element",tag:I,attributes:{},children:[]};G(J,true);B(J);D=J.parent}}});while(D!==C){B(D);D=D.parent}return C}}();var k=function(){var v={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function u(w){return v[w]}return function(w){return w?w.replace(/[<>"']/g,u):""}}();var m=function(){function v(B){var A=B.children;var C=[];for(var z=0,y;y=A[z];z++){C.push(m(y))}return C.join("")}function w(z){var A=[];for(var y in z){A.push(y+'="'+k(z[y])+'"')}return A.join(" ")}function u(y){return k(y.data)}function x(B){var y=B.tag;var z=w(B.attributes);var A="<"+y+(z?" "+z:"")+(g[y]?" />":">");if(!g[y]){A+=v(B);A+="</"+y+">"}return A}return function(y){if(y.type=="fragment"){return v(y)}else{if(y.type=="element"){return x(y)}else{if(y.type=="text"||y.type=="cdata"){return u(y)}else{if(y.type=="comment"){return"<!--"+y.data+"-->"}}}}return""}}();var i=function(){function v(y){var x=new RegExp(/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument)/ig);return x.test(y)}function w(x){x=x.replace(/([\d.]+)([\w]+)?/g,function(y,A,z){return(Math.round(parseFloat(A))||1)+(z||"px")});return x}function u(x){x=x.replace(/<!--\s*EndFragment\s*-->[\s\S]*$/,"");x=x.replace(/\r\n|\n|\r/ig,"");x=x.replace(/^\s*(&nbsp;)+/ig,"");x=x.replace(/(&nbsp;|<br[^>]*>)+\s*$/ig,"");x=x.replace(/<!--[\s\S]*?-->/ig,"");x=x.replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|img|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"");x=x.replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>");x=x.replace(/(lang)\s*=\s*([\'\"]?)[\w-]+\2/ig,"");x=x.replace(/(<[a-z][^>]*)\sstyle="([^"]*)"/gi,function(D,H,y){var A=[],C=0,G=y.replace(/^\s+|\s+$/,"").replace(/&quot;/gi,"'").split(/;\s*/g);for(var C=0;C<G.length;C++){var F=G[C];var z,E,B=F.split(":");if(B.length==2){z=B[0].toLowerCase();E=B[1].toLowerCase();switch(z){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-table-layout-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":A[C++]=z.replace(/^mso-|-alt$/g,"")+":"+w(E);continue;case"horiz-align":A[C++]="text-align:"+E;continue;case"vert-align":A[C++]="vertical-align:"+E;continue;case"font-color":case"mso-foreground":A[C++]="color:"+E;continue;case"mso-background":case"mso-highlight":A[C++]="background:"+E;continue;case"mso-default-height":A[C++]="min-height:"+w(E);continue;case"mso-default-width":A[C++]="min-width:"+w(E);continue;case"mso-padding-between-alt":A[C++]="border-collapse:separate;border-spacing:"+w(E);continue;case"text-line-through":if((E=="single")||(E=="double")){A[C++]="text-decoration:line-through"}continue;case"mso-zero-height":if(E=="yes"){A[C++]="display:none"}continue}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:align|decor|indent|trans)|top-bar|version|vnd|word-break)/.test(z)){if(!/mso-list/.test(z)){continue}}A[C]=z+":"+B[1]}}if(C>0){return H+' style="'+A.join(";")+'"'}else{return H}});x=x.replace(/([ ]+)<\/span>/ig,function(y,z){return new Array(z.length+1).join("&nbsp;")+"</span>"});return x}return function(x){f=null;r="",j="",p="";if(v(x)){x=u(x)}return x.replace(/>\s*</g,"><")}}();var b={text:"#text",comment:"#comment",cdata:"#cdata-section",fragment:"#document-fragment"};function s(v){var u;if(v&&v.tag=="p"){if(v.attributes["class"]=="MsoListParagraph"||/mso-list/.test(v.attributes.style)){u=1}else{var w=v.children[0];if(w&&w.tag=="span"&&/Wingdings/i.test(w.attributes.style)){u=1}}}return u}var f,c={decimal:/\d+/,"lower-roman":/^m{0,4}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})$/,"upper-roman":/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/,"lower-alpha":/^\(?[a-z]+\)?$/,"upper-alpha":/^\(?[A-Z]+\)?$/},h={disc:/^[l\u00B7\u2002]/,circle:/^[\u006F\u00D8]/,square:/^[\u006E\u25C6]/},r="",j="",p;function e(x){if(x.type=="element"&&!x.children.length&&o.$removeEmpty[x.tag]&&x.tag!="a"){return{type:"fragment",children:[]}}var B=[0,10,12,16,18,24,32,48],A,C=baidu.editor.utils.indexOf;switch(x.tag){case"a":if(x.attributes.name){x.tag="img";x.attributes={"class":"anchorclass",anchorname:x.attributes.name};x.closed=1}break;case"b":x.tag=x.name="strong";break;case"i":x.tag=x.name="em";break;case"u":x.tag=x.name="span";x.attributes.style=(x.attributes.style||"")+";text-decoration:underline;";break;case"s":case"del":x.tag=x.name="span";x.attributes.style=(x.attributes.style||"")+";text-decoration:line-through;";break;case"span":if(/mso-list/.test(x.attributes.style)){if(p!="end"){var D=x.children[0],w;while(D.type=="element"){D=D.children[0]}for(w in h){if(h[w].test(D.data)){r="ul";j=w;break}}if(!r){for(w in c){if(c[w].test(D.data.replace(/\.$/,""))){r="ol";j=w;break}}}if(p){if(D.data==p){if(r!="ul"){j=""}r="ul"}else{if(r!="ol"){j=""}r="ol"}p="end"}else{p=D.data}if(r){var y=x;while(y.tag!="ul"&&y.tag!="ol"){y=y.parent}y.tag=r;y.attributes.style="list-style-type:"+j}}x={type:"fragment",children:[]};break}var v=x.attributes.style;if(v){v=v.replace(/background(?!-)/g,"background-color");v=v.match(/(?:\b(?:color|font-size|background-color|font-size|font-family|text-decoration)\b\s*:\s*(&[^;]+;|[^;])+(?=;)?)/gi);if(v){x.attributes.style=v.join(";");if(!x.attributes.style){delete x.attributes.style}}}break;case"font":x.tag=x.name="span";A=x.attributes;x.attributes={style:(A.size?"font-size:"+(B[A.size]||12)+"px":"")+";"+(A.color?"color:"+A.color:"")+";"+(A.face?"font-family:"+A.face:"")+";"+(A.style||"")};break;case"p":if(x.attributes.align){x.attributes.style=(x.attributes.style||"")+";text-align:"+x.attributes.align+";";delete x.attributes.align}if(s(x)){if(!f){var u={type:"element",tag:"ul",attributes:{},children:[]},z=C(x.parent.children,x);x.parent.children[z]=u;u.parent=x.parent;u.children[0]=x;x.parent=u;while(1){x=u.parent.children[z+1];if(s(x)){u.children[u.children.length]=x;x.parent=u;u.parent.children.splice(z+1,1)}else{break}}return u}x.tag=x.name="li";delete x.attributes["class"];delete x.attributes.style}}return x}function l(u){switch(u.tag){case"td":if(/display\s*:\s*none/i.test(u.attributes.style)){return{type:"fragment",children:[]}}if(t.ie&&!u.children.length){var v={type:"text",data:"&nbsp;",parent:u};u.children[0]=v}break;case"img":if(u.attributes.anchorname){u.tag="a";u.attributes={name:u.attributes.anchorname};u.closed=null}}return u}function a(A,z,u){if(!A.children||!A.children.length){return A}var y=A.children;for(var x=0;x<y.length;x++){var w=z(y[x],u);if(w.type=="fragment"){var v=[x,1];v.push.apply(v,w.children);y.splice.apply(y,v);if(!y.length){A={type:"fragment",children:[]}}x--}else{y[x]=w}}return A}function q(u){this.rules=u}q.prototype={rules:null,filter:function(w,z,y){z=z||this.rules;var v=z&&z.whiteList;var u=z&&z.blackList;function x(E,D){E.name=E.type=="element"?E.tag:b[E.type];if(D==null){return a(E,x,E)}if(u&&u[E.name]){return{type:"fragment",children:[]}}if(v){if(E.type=="element"){if(D.type=="fragment"?v[E.name]:v[E.name]&&v[D.name][E.name]){var C;if((C=v[E.name].$)){var F=E.attributes;var B={};for(var A in C){if(F[A]){B[A]=F[A]}}E.attributes=B}}else{y&&(y.flag=1);E.type="fragment";E.name=D.name}}else{}}if(u||v){a(E,x,E)}return E}return x(w,null)},transformInput:function(u,w){function v(x){x=e(x);if(x.tag=="ol"||x.tag=="ul"){f=1}x=a(x,v,x);if(x.tag=="ol"||x.tag=="ul"){f=0;r="",j="",p=""}if(x.type=="text"&&x.data.replace(/\s/g,"")==d.options.pageBreakTag){x.type="element";x.name=x.tag="div";delete x.data;x.attributes={"class":"pagebreak"};x.children=[]}return x}return v(u)},transformOutput:function(u){function v(w){if(w.tag=="div"&&w.attributes["class"]=="pagebreak"){delete w.tag;w.type="text";w.data=d.options.pageBreakTag;delete w.children}w=l(w);if(w.tag=="ol"||w.tag=="ul"){f=1}w=a(w,v,w);if(w.tag=="ol"||w.tag=="ul"){f=0}return w}return v(u)},toHTML:m,parseHTML:n,word:i};d.serialize=new q(d.options.serialize);baidu.editor.serialize=new q({})}})();(function(){var a=baidu.editor.dom.domUtils,b=baidu.editor.browser;function c(h){var f=this.document;if(f.getElementById("baidu_pastebin")){return}var e=this.selection.getRange(),d=e.createBookmark(),g=f.createElement("div");g.id="baidu_pastebin";b.webkit&&g.appendChild(f.createTextNode(a.fillChar+a.fillChar));f.body.appendChild(g);g.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+a.getXY(d.start).y+"px";e.selectNodeContents(g).select(true);setTimeout(function(){g.parentNode.removeChild(g);e.moveToBookmark(d).select(true);h(g)},0)}baidu.editor.plugins.paste=function(){var g=this;var f=g.options.pasteplain;var d={flag:""};g.commands.pasteplain={queryCommandState:function(){return f},execCommand:function(){f=!f|0},notNeedUndo:1};function e(s){var r;if(s.firstChild){var w=a.getElementsByTagName(s,"span");for(var z=0,l;l=w[z++];){if(l.id=="_baidu_cut_start"||l.id=="_baidu_cut_end"){a.remove(l)}}if(b.webkit){var y=s.querySelectorAll("div #baidu_pastebin"),u;for(var z=0,A;A=y[z++];){u=g.document.createElement("p");while(A.firstChild){u.appendChild(A.firstChild)}A.parentNode.insertBefore(u,A);a.remove(A,true)}var n=s.querySelectorAll("span.Apple-style-span");for(var z=0,o;o=n[z++];){a.remove(o,true)}var h=s.querySelectorAll("meta");for(var z=0,o;o=h[z++];){a.remove(o)}var t=s.querySelectorAll("div br");for(var z=0,j;j=t[z++];){var q=j.parentNode;if(q.tagName=="DIV"&&q.childNodes.length==1){a.remove(q)}}}if(b.gecko){var v=s.querySelectorAll("[_moz_dirty]");for(z=0;o=v[z++];){o.removeAttribute("_moz_dirty")}}r=s.innerHTML;var B=g.serialize;if(B){var x=B.transformInput(B.parseHTML(B.word(r),true));x=B.filter(x,f?{whiteList:{p:{$:{}}},blackList:{style:1,script:1,object:1}}:null,d);if(b.webkit){var k=x.children.length,m;while((m=x.children[k-1])&&m.tag=="br"){x.children.splice(k-1,1);k=x.children.length}}r=B.toHTML(x)}g.fireEvent("beforepaste",r);g.execCommand("insertHtml",r)}}g.addListener("ready",function(){a.on(g.body,"cut",function(){var j=g.selection.getRange();if(!j.collapsed&&g.undoManger){g.undoManger.save()}j=g.selection.getRange();if(!j.collapsed){var k=0,h=0;while(!j.startOffset&&!a.isBody(j.startContainer)){k=1;j.setStartBefore(j.startContainer)}while(!a.isBody(j.endContainer)&&j.endOffset==(j.endContainer.nodeType==1?j.endContainer.childNodes.length:j.endContainer.nodeValue.length)){h=1;j.setEndAfter(j.endContainer);if(b.webkit){var m=j.endContainer.childNodes[j.endOffset];if(m&&m.nodeType==1&&m.tagName=="BR"&&j.endContainer.lastChild===m){j.setEndAfter(m)}}}if(k){var l=g.document.createElement("span");l.innerHTML="start";l.id="_baidu_cut_start";j.insertNode(l).setStartBefore(l)}if(h){var i=g.document.createElement("span");i.innerHTML="end";i.id="_baidu_cut_end";j.cloneRange().collapse(false).insertNode(i);j.setEndAfter(i)}j.select();if(b.ie){setTimeout(function(){var n=g.document.getElementById("_baidu_cut_end");n&&a.remove(n)},50)}}});a.on(g.body,b.ie?"beforepaste":"paste",function(h){c.call(g,function(i){e(i);if(d.flag){editor.ui.showToolbarMsg("");d.flag=""}})})})}})();baidu.editor.plugins.shortcutkeys=function(){var a=this,b=baidu.editor.utils.extend({"ctrl+66":"Bold","ctrl+90":"Undo","ctrl+89":"Redo","ctrl+73":"Italic","ctrl+85":"Underline:Underline","ctrl+shift+67":"removeformat","ctrl+shift+76":"justify:left","ctrl+shift+82":"justify:right","ctrl+65":"selectAll"},a.options.shortcutkeys);a.addListener("keydown",function(d,h){var g=h.keyCode||h.which,f;for(var c in b){if(/^(ctrl)(\+shift)?\+(\d+)$/.test(c.toLowerCase())||/^(\d+)$/.test(c)){if(((RegExp.$1=="ctrl"?(h.ctrlKey||h.metaKey):0)&&(RegExp.$2!=""?h[RegExp.$2.slice(1)+"Key"]:1)&&g==RegExp.$3)||g==RegExp.$1){f=b[c].split(":");a.execCommand(f[0],f[1]);h.preventDefault?h.preventDefault():(h.returnValue=false)}}}})};var baidu=baidu||{};baidu.editor=baidu.editor||{};baidu.editor.ui={};(function(){var d=baidu.editor.browser,c=baidu.editor.dom.domUtils;var g="$EDITORUI";var f=window[g]={};var a="ID"+g;var i=0;var b=baidu.editor.ui.uiUtils={uid:function(j){return(j?j[a]||(j[a]=++i):++i)},hook:function(j,l){var k;if(j&&j._callbacks){k=j}else{k=function(){var p;if(j){p=j.apply(this,arguments)}var o=k._callbacks;var m=o.length;while(m--){var n=o[m].apply(this,arguments);if(p===undefined){p=n}}return p};k._callbacks=[]}k._callbacks.push(l);return k},createElementByHtml:function(j){var k=document.createElement("div");k.innerHTML=j;k=k.firstChild;k.parentNode.removeChild(k);return k},getViewportElement:function(){return(d.ie&&d.quirks)?document.body:document.documentElement},getClientRect:function(j){var m=j.getBoundingClientRect();var k={left:Math.round(m.left),top:Math.round(m.top),height:Math.round(m.bottom-m.top),width:Math.round(m.right-m.left)};var l;while((l=j.ownerDocument)!==document&&(j=c.getWindow(l).frameElement)){m=j.getBoundingClientRect();k.left+=m.left;k.top+=m.top}k.bottom=k.top+k.height;k.right=k.left+k.width;return k},getViewportRect:function(){var k=b.getViewportElement();var l=k.clientWidth|0;var j=k.clientHeight|0;return{left:0,top:0,height:j,width:l,bottom:j,right:l}},setViewportOffset:function(j,n){var m=parseInt(j.style.left)|0;var l=parseInt(j.style.top)|0;var k=b.getClientRect(j);m=m+n.left-k.left;l=l+n.top-k.top;j.style.left=m+"px";j.style.top=l+"px"},getEventOffset:function(j){var k=j.target||j.srcElement;var l=b.getClientRect(k);var m=b.getViewportOffsetByEvent(j);return{left:m.left-l.left,top:m.top-l.top}},getViewportOffsetByEvent:function(k){var l=k.target||k.srcElement;var j=c.getWindow(l).frameElement;var n={left:k.clientX,top:k.clientY};if(j&&l.ownerDocument!==document){var m=b.getClientRect(j);n.left+=m.left;n.top+=m.top}return n},setGlobal:function(k,j){f[k]=j;return g+'["'+k+'"]'},unsetGlobal:function(j){delete f[j]},copyAttributes:function(o,n){var l=n.attributes;var j=l.length;while(j--){var m=l[j];if(m.nodeName!="style"&&m.nodeName!="class"&&(!d.ie||m.specified)){o.setAttribute(m.nodeName,m.nodeValue)}}if(n.className){o.className+=" "+n.className}if(n.style.cssText){o.style.cssText+=";"+n.style.cssText}},removeStyle:function(k,j){if(k.style.removeProperty){k.style.removeProperty(j)}else{if(k.style.removeAttribute){k.style.removeAttribute(j)}else{throw""}}},contains:function(k,j){return k&&j&&(k===j?false:(k.contains?k.contains(j):k.compareDocumentPosition(j)&16))},startDrag:function(r,n){var p=document;var m=r.clientX;var l=r.clientY;function k(t){var s=t.clientX-m;var u=t.clientY-l;n.ondragmove(s,u);if(t.stopPropagation){t.stopPropagation()}else{t.cancelBubble=true}}if(p.addEventListener){function q(s){p.removeEventListener("mousemove",k,true);p.removeEventListener("mouseup",k,true);n.ondragstop()}p.addEventListener("mousemove",k,true);p.addEventListener("mouseup",q,true);r.preventDefault()}else{var o=r.srcElement;o.setCapture();function j(){o.releaseCapture();o.detachEvent("onmousemove",k);o.detachEvent("onmouseup",j);o.detachEvent("onlosecaptrue",j);n.ondragstop()}o.attachEvent("onmousemove",k);o.attachEvent("onmouseup",j);o.attachEvent("onlosecaptrue",j);r.returnValue=false}n.ondragstart()},getFixedLayer:function(){var j=document.getElementById("edui_fixedlayer");if(j==null){j=document.createElement("div");j.id="edui_fixedlayer";document.body.appendChild(j);if(d.ie&&d.version<=8){j.style.position="absolute";h();setTimeout(e)}else{j.style.position="fixed"}j.style.left="0";j.style.top="0";j.style.width="0";j.style.height="0"}return j},makeUnselectable:function(k){if(d.opera||(d.ie&&d.version<9)){k.unselectable="on";if(k.hasChildNodes()){for(var j=0;j<k.childNodes.length;j++){if(k.childNodes[j].nodeType==1){b.makeUnselectable(k.childNodes[j])}}}}else{if(k.style.MozUserSelect!==undefined){k.style.MozUserSelect="none"}else{if(k.style.WebkitUserSelect!==undefined){k.style.WebkitUserSelect="none"}else{if(k.style.KhtmlUserSelect!==undefined){k.style.KhtmlUserSelect="none"}}}}},mapUrl:function(j){return j.replace("~/",baidu.editor.config.UEDITOR_HOME_URL)}};function e(){var j=document.getElementById("edui_fixedlayer");b.setViewportOffset(j,{left:0,top:0});j.style.display="none";j.style.display="block"}function h(j){c.on(window,"scroll",e)}})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,c=baidu.editor.EventBase,d=baidu.editor.ui.UIBase=function(){};d.prototype={className:"",uiName:"",initOptions:function(f){var g=this;for(var e in f){g[e]=f[e]}this.id=this.id||"edui"+b.uid()},initUIBase:function(){this._globalKey=a.unhtml(b.setGlobal(this.id,this))},render:function(f){var e=this.renderHtml();var g=b.createElementByHtml(e);var h=this.getDom();if(h!=null){h.parentNode.replaceChild(g,h);b.copyAttributes(g,h)}else{if(typeof f=="string"){f=document.getElementById(f)}f=f||b.getFixedLayer();f.appendChild(g)}this.postRender()},getDom:function(e){if(!e){return document.getElementById(this.id)}else{return document.getElementById(this.id+"_"+e)}},postRender:function(){},getHtmlTpl:function(){return""},formatHtml:function(e){var f="edui-"+this.uiName;return(e.replace(/##/g,this.id).replace(/%%-/g,this.uiName?f+"-":"").replace(/%%/g,(this.uiName?f:"")+" "+this.className).replace(/\$\$/g,this._globalKey))},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var e=this.getDom();if(e){domUtils.remove(e)}b.unsetGlobal(this.id)}};a.inherits(d,c)})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.UIBase,c=baidu.editor.ui.Separator=function(d){this.initOptions(d);this.initSeparator()};c.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}};a.inherits(c,b)})();(function(){var b=baidu.editor.utils,d=baidu.editor.browser,a=baidu.editor.dom.domUtils,e=baidu.editor.ui.UIBase,c=baidu.editor.ui.uiUtils;var f=baidu.editor.ui.Mask=function(g){this.initOptions(g);this.initUIBase()};f.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var g=this;a.on(window,"resize",function(){setTimeout(function(){if(!g.isHidden()){g._fill()}})})},show:function(){this._fill();this.getDom().style.display=""},hide:function(){this.getDom().style.display="none"},isHidden:function(){return this.getDom().style.display=="none"},_onMouseDown:function(){return false},_fill:function(){var g=this.getDom();var h=c.getViewportRect();g.style.width=h.width+"px";g.style.height=h.height+"px"}};b.inherits(f,e)})();(function(){var c=baidu.editor.utils,e=baidu.editor.ui.uiUtils,a=baidu.editor.dom.domUtils,h=baidu.editor.ui.UIBase,g=baidu.editor.ui.Popup=function(i){this.initOptions(i);this.initPopup()};var b=[];function f(l){var m=[];for(var k=0;k<b.length;k++){var j=b[k];if(!j.isHidden()){if(j.queryAutoHide(l)!==false){j.hide()}}}}g.postHide=f;var d=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];g.prototype={SHADOW_RADIUS:5,content:null,_hidden:false,initPopup:function(){this.initUIBase();b.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%"> <div id="##_body" class="edui-popup-body">  <div class="edui-shadow"></div>  <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div> </div></div>"},getContentHtmlTpl:function(){if(typeof this.content=="string"){return this.content}return this.content.renderHtml()},postRender:function(){if(this.content instanceof h){this.content.postRender()}this.hide()},mesureSize:function(){var i=this.getDom("content");return e.getClientRect(i)},fitSize:function(){var i=this.getDom("body");i.style.width="";i.style.height="";var j=this.mesureSize();i.style.width=j.width+"px";i.style.height=j.height+"px";return j},showAnchor:function(j,i){this.showAnchorRect(e.getClientRect(j),i)},showAnchorRect:function(p,m,n){var k=e.getViewportRect();this._show();var j=this.fitSize();var q,l,i,o;if(m){q=(p.right+j.width>k.right&&p.left>j.width);l=(p.top+j.height>k.bottom&&p.bottom>j.height);i=p.right+j.width>k.right?(p.left>j.width?p.left-j.width:(n?k.right-j.width:p.right)):p.right;o=p.top+j.height>k.bottom?(p.bottom>j.height?p.bottom-j.height:(n?k.bottom-j.height:p.top)):p.top}else{q=(p.right+j.width>k.right&&p.left>j.width);l=(p.top+j.height>k.bottom&&p.bottom>j.height);i=p.right+j.width>k.right?(p.left>j.width?p.right-j.width:(n?k.right-j.width:p.left)):p.left;o=p.bottom+j.height>k.bottom?(p.top>j.height?p.top-j.height:(n?k.bottom-j.height:p.bottom)):p.bottom}var r=this.getDom();e.setViewportOffset(r,{left:i,top:o});a.removeClasses(r,d);r.className+=" "+d[(l?1:0)*2+(q?1:0)]},showAt:function(l){var k=l.left;var j=l.top;var i={left:k,top:j,right:k,bottom:j,height:0,width:0};this.showAnchorRect(i,false,true)},_show:function(){if(this._hidden){var i=this.getDom();i.style.display="";this._hidden=false;this.fireEvent("show")}},isHidden:function(){return this._hidden},show:function(){this._show()},hide:function(){if(!this._hidden){this.getDom().style.display="none";this._hidden=true;this.fireEvent("hide")}},queryAutoHide:function(i){return !i||!e.contains(this.getDom(),i)}};c.inherits(g,h);a.on(document,"mousedown",function(i){var j=i.target||i.srcElement;f(j)});a.on(window,"scroll",function(){f()})})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.Utils,e=baidu.editor.ui.Popup,d=baidu.editor.ui.UIBase,c=baidu.editor.ui.ColorPicker=function(h){this.initOptions(h);this.noColorText=this.noColorText||"";this.initUIBase()};c.prototype={getHtmlTpl:function(){return g(this.noColorText)},_onTableClick:function(h){var j=h.target||h.srcElement;var i=j.getAttribute("data-color");if(i){this.fireEvent("pickcolor",i)}},_onTableOver:function(h){var j=h.target||h.srcElement;var i=j.getAttribute("data-color");if(i){this.getDom("preview").style.backgroundColor=i}},_onTableOut:function(){this.getDom("preview").style.backgroundColor=""},_onPickNoColor:function(){this.fireEvent("picknocolor")}};a.inherits(c,d);var f=("ff0000,ffa900,ffff00,99e600,00cc22,00ffff,00aaff,0055ff,5500ff,aa00ff,ff007f,ffffff,ffe5e5,fff2d9,ffffcc,eeffcc,d9ffe0,d9ffff,d9f2ff,d9e6ff,e6d9ff,f2d9ff,ffd9ed,d9d9d9,e68a8a,e6c78a,ffff99,bfe673,99eea0,a1e6e6,99ddff,8aa8e6,998ae6,c78ae6,e68ab9,b3b3b3,cc5252,cca352,d9d957,a7cc39,57ce6d,52cccc,52a3cc,527acc,6652cc,a352cc,cc5291,8c8c8c,991f1f,99701f,99991f,59800d,0f9932,1f9999,1f7099,1f4799,471f99,701f99,991f5e,404040,660000,664b14,666600,3b5900,005916,146666,144b66,143066,220066,301466,66143f,000000").split(",");function g(h){var k='<div id="##" class="edui-colorpicker %%"><div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div><div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">'+h+'</div></div><table class="edui-box" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0"><tr class="edui-colorpicker-tablefirstrow">';for(var j=0;j<f.length;j++){if(j&&j%12===0){k+="</tr><tr>"}k+='<td><a hidefocus onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell" data-color="#'+f[j]+'" style="background-color:#'+f[j]+';"></a></td>'}k+="</tr></table></div>";return k}})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,c=baidu.editor.ui.UIBase;var d=baidu.editor.ui.TablePicker=function(e){this.initOptions(e);this.initTablePicker()};d.prototype={defaultNumRows:10,defaultNumCols:10,maxNumRows:20,maxNumCols:20,numRows:10,numCols:10,lengthOfCellSide:22,initTablePicker:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-tablepicker %%"><div class="edui-tablepicker-body"><div class="edui-infoarea"><span id="##_label" class="edui-label"></span><span class="edui-clickable" onclick="$$._onMore();"></span></div><div class="edui-pickarea" onmousemove="$$._onMouseMove(event, this);" onmouseover="$$._onMouseOver(event, this);" onmouseout="$$._onMouseOut(event, this);" onclick="$$._onClick(event, this);"><div id="##_overlay" class="edui-overlay"></div></div></div></div>'},_UIBase_render:c.prototype.render,render:function(e){this._UIBase_render(e);this.getDom("label").innerHTML="0 x 0"},_track:function(i,h){var f=this.getDom("overlay").style;var g=this.lengthOfCellSide;f.width=i*g+"px";f.height=h*g+"px";var e=this.getDom("label");e.innerHTML=i+" x "+h+"";this.numCols=i;this.numRows=h},_onMouseOver:function(f,g){var e=f.relatedTarget||f.fromElement;if(!b.contains(g,e)&&g!==e){this.getDom("label").innerHTML="0 x 0";this.getDom("overlay").style.visibility=""}},_onMouseOut:function(f,g){var e=f.relatedTarget||f.toElement;if(!b.contains(g,e)&&g!==e){this.getDom("label").innerHTML="0 x 0";this.getDom("overlay").style.visibility="hidden"}},_onMouseMove:function(e,g){var f=this.getDom("overlay").style;var k=b.getEventOffset(e);var i=this.lengthOfCellSide;var j=Math.ceil(k.left/i);var h=Math.ceil(k.top/i);this._track(j,h)},_onClick:function(){this.fireEvent("picktable",this.numCols,this.numRows)},_onMore:function(){this.fireEvent("more")}};a.inherits(d,c)})();(function(){var c=baidu.editor.browser,a=baidu.editor.dom.domUtils,b=baidu.editor.ui.uiUtils;var d='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(c.ie?(' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"'):(' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"'));baidu.editor.ui.Stateful={alwalysHoverable:false,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl;this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){var e=this._Stateful_dGetHtmlTpl();return e.replace(/stateful/g,function(){return d})},Stateful_onMouseEnter:function(e,f){if(!this.isDisabled()||this.alwalysHoverable){this.addState("hover");this.fireEvent("over")}},Stateful_onMouseLeave:function(e,f){if(!this.isDisabled()||this.alwalysHoverable){this.removeState("hover");this.removeState("active");this.fireEvent("out")}},Stateful_onMouseOver:function(f,g){var e=f.relatedTarget;if(!b.contains(g,e)&&g!==e){this.Stateful_onMouseEnter(f,g)}},Stateful_onMouseOut:function(f,g){var e=f.relatedTarget;if(!b.contains(g,e)&&g!==e){this.Stateful_onMouseLeave(f,g)}},Stateful_onMouseDown:function(e,f){if(!this.isDisabled()){this.addState("active")}},Stateful_onMouseUp:function(e,f){if(!this.isDisabled()){this.removeState("active")}},Stateful_postRender:function(){if(this.disabled&&!this.hasState("disabled")){this.addState("disabled")}},hasState:function(e){return a.hasClass(this.getStateDom(),"edui-state-"+e)},addState:function(e){if(!this.hasState(e)){this.getStateDom().className+=" edui-state-"+e}},removeState:function(e){if(this.hasState(e)){a.removeClasses(this.getStateDom(),["edui-state-"+e])}},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(e){if(!this.isDisabled()&&e){this.addState("checked")}else{this.removeState("checked")}},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(e){if(e){this.removeState("hover");this.removeState("checked");this.removeState("active");this.addState("disabled")}else{this.removeState("disabled")}}}})();(function(){var b=baidu.editor.utils,d=baidu.editor.ui.UIBase,c=baidu.editor.ui.Stateful,a=baidu.editor.ui.Button=function(e){this.initOptions(e);this.initButton()};a.prototype={uiName:"button",label:"",title:"",initButton:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return false;" onclick="return $$._onClick();"><div class="edui-box edui-icon"></div><div class="edui-box edui-label">'+this.label+"</div></div></div></div></div>"},postRender:function(){this.Stateful_postRender()},_onClick:function(){if(!this.isDisabled()){this.fireEvent("click")}}};b.inherits(a,d);b.extend(a.prototype,c)})();(function(){var c=baidu.editor.utils,a=baidu.editor.dom.domUtils,e=baidu.editor.ui.uiUtils,g=baidu.editor.ui.UIBase,d=baidu.editor.ui.Stateful,f=baidu.editor.ui.Popup,h=baidu.editor.ui.Mask,b=baidu.editor.ui.SplitButton=function(i){this.initOptions(i);this.initSplitButton()};b.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){this.initUIBase();this.Stateful_init();var i=this},postRender:function(){this.popup.className=this.className;this.popup.render();this.popup.addListener("show",c.bind(this._onPopupShow,this));this.popup.addListener("hide",c.bind(this._onPopupHide,this));this.popup.getDom("body").appendChild(e.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(e.getClientRect(this.getDom()).width-2)+'px"></div>'));this.Stateful_postRender()},_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body"><div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);"><div class="edui-box edui-icon"></div></div><div class="edui-box edui-splitborder"></div><div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div></div></div></div>'},showPopup:function(){var i=e.getClientRect(this.getDom());i.top-=this.popup.SHADOW_RADIUS;i.height+=this.popup.SHADOW_RADIUS;this.popup.showAnchorRect(i)},_onArrowClick:function(j,i){if(!this.isDisabled()){this.showPopup()}},_onButtonClick:function(){if(!this.isDisabled()){this.fireEvent("buttonclick")}}};c.inherits(b,g);c.extend(b.prototype,d,true)})();(function(){var b=baidu.editor.utils,c=baidu.editor.ui.uiUtils,d=baidu.editor.ui.ColorPicker,f=baidu.editor.ui.Popup,a=baidu.editor.ui.SplitButton,e=baidu.editor.ui.ColorButton=function(g){this.initOptions(g);this.initColorButton()};e.prototype={initColorButton:function(){var g=this;this.popup=new f({content:new d({noColorText:"",onpickcolor:function(i,h){g._onPickColor(h)},onpicknocolor:function(i,h){g._onPickNoColor(h)}})});this.initSplitButton()},_SplitButton_postRender:a.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.getDom("button_body").appendChild(c.createElementByHtml('<div id="'+this.id+'_colorlump" class="edui-colorlump"></div>'));this.getDom().className+=" edui-colorbutton"},setColor:function(g){this.getDom("colorlump").style.backgroundColor=g;this.color=g},_onPickColor:function(g){if(this.fireEvent("pickcolor",g)!==false){this.setColor(g);this.popup.hide()}},_onPickNoColor:function(g){if(this.fireEvent("picknocolor")!==false){this.popup.hide()}}};b.inherits(e,a)})();(function(){var b=baidu.editor.utils,e=baidu.editor.ui.Mask,c=baidu.editor.ui.Popup,d=baidu.editor.ui.TablePicker,a=baidu.editor.ui.SplitButton,f=baidu.editor.ui.TableButton=function(g){this.initOptions(g);this.initTableButton()};f.prototype={initTableButton:function(){this.initSplitButton();var g=this;this.popup=new c({content:new d({onpicktable:function(h,j,i){g._onPickTable(j,i)},onmore:function(){g.popup.hide();g.fireEvent("more")}})})},_onPickTable:function(h,g){if(this.fireEvent("picktable",h,g)!==false){this.popup.hide()}}};b.inherits(f,a)})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,d=baidu.editor.ui.UIBase,c=baidu.editor.ui.Toolbar=function(e){this.initOptions(e);this.initToolbar()};c.prototype={items:null,initToolbar:function(){this.items=this.items||[];this.initUIBase()},add:function(e){this.items.push(e)},getHtmlTpl:function(){var f=[];for(var e=0;e<this.items.length;e++){f[e]=this.items[e].renderHtml()}return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+f.join("")+"</div>"},postRender:function(){var f=this.getDom();for(var e=0;e<this.items.length;e++){this.items[e].postRender()}b.makeUnselectable(f)},_onMouseDown:function(){return false}};a.inherits(c,d)})();(function(){var h=baidu.editor.utils,d=baidu.editor.dom.domUtils,b=baidu.editor.ui.uiUtils,c=baidu.editor.ui.UIBase,i=baidu.editor.ui.Popup,a=baidu.editor.ui.Stateful,e=baidu.editor.ui.Menu=function(j){this.initOptions(j);this.initMenu()};var f={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'},postRender:function(){},queryAutoHide:function(){return true}};e.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[];this.initPopup();this.initItems()},initItems:function(){for(var j=0;j<this.items.length;j++){var k=this.items[j];if(k=="-"){this.items[j]=this.getSeparator()}else{if(!(k instanceof g)){this.items[j]=this.createItem(k)}}}},getSeparator:function(){return f},createItem:function(j){return new g(j)},getContentHtmlTpl:function(){var l=[];for(var j=0;j<this.items.length;j++){var k=this.items[j];l[j]=k.renderHtml()}return('<div class="%%-body">'+l.join("")+"</div>")},_Popup_postRender:i.prototype.postRender,postRender:function(){var l=this;for(var j=0;j<this.items.length;j++){var k=this.items[j];k.ownerMenu=this;k.postRender()}d.on(this.getDom(),"mouseover",function(n){n=n||event;var m=n.relatedTarget||n.fromElement;var o=l.getDom();if(!b.contains(o,m)&&o!==m){l.fireEvent("over")}});this._Popup_postRender()},queryAutoHide:function(k){if(k){if(b.contains(this.getDom(),k)){return false}for(var j=0;j<this.items.length;j++){var l=this.items[j];if(l.queryAutoHide(k)===false){return false}}}},destroy:function(){if(this.getDom()){d.remove(this.getDom())}for(var j=0;j<this.items.length;j++){var k=this.items[j];if(k.subMenu){k.subMenu.destroy()}}}};h.inherits(e,i);var g=baidu.editor.ui.MenuItem=function(j){this.initOptions(j);this.initUIBase();this.Stateful_init();if(this.subMenu&&!(this.subMenu instanceof e)){this.subMenu=new e(this.subMenu)}};g.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:true,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div></div>"},postRender:function(){if(this.subMenu){this.getDom().className+=" edui-hassubmenu";this.subMenu.render();var j=this;this.addListener("over",function(){j.ownerMenu.fireEvent("submenuover",j);j.delayShowSubMenu()});this.addListener("out",function(){j.delayHideSubMenu()});this.subMenu.addListener("over",function(){clearTimeout(j._closingTimer);j.addState("opened")});this.ownerMenu.addListener("hide",function(){j.hideSubMenu()});this.ownerMenu.addListener("submenuover",function(l,k){if(k!==j){j.delayHideSubMenu()}});this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide;this.subMenu.queryAutoHide=function(k){if(k&&b.contains(j.getDom(),k)){return false}return this._bakQueryAutoHide(k)}}this.getDom().style.tabIndex="-1";b.makeUnselectable(this.getDom());this.Stateful_postRender()},delayShowSubMenu:function(){var j=this;if(!j.isDisabled()){j.addState("opened");clearTimeout(j._showingTimer);clearTimeout(j._closingTimer);j._showingTimer=setTimeout(function(){j.showSubMenu()},250)}},delayHideSubMenu:function(){var j=this;if(!j.isDisabled()){j.removeState("opened");clearTimeout(j._showingTimer);clearTimeout(j._closingTimer);j._closingTimer=setTimeout(function(){if(!j.hasState("opened")){j.hideSubMenu()}},250)}},renderLabelHtml:function(){return'<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(j){if(this.subMenu&&this.hasState("opened")){return this.subMenu.queryAutoHide(j)}},_onClick:function(j,k){if(this.hasState("disabled")){return}if(this.fireEvent("click",j,k)!==false){if(this.subMenu){this.showSubMenu()}else{i.postHide()}}},showSubMenu:function(){var j=b.getClientRect(this.getDom());j.right-=5;j.left+=2;j.width-=7;j.top-=4;j.bottom+=4;j.height+=8;this.subMenu.showAnchorRect(j,true,true)},hideSubMenu:function(){this.subMenu.hide()}};h.inherits(g,c);h.extend(g.prototype,a,true)})();(function(){var b=baidu.editor.utils,d=baidu.editor.ui.uiUtils,f=baidu.editor.ui.Menu,e=baidu.editor.ui.MenuItem,a=baidu.editor.ui.SplitButton,c=baidu.editor.ui.Combox=function(g){this.initOptions(g);this.initCombox()};c.prototype={uiName:"combox",initCombox:function(){var j=this;this.items=this.items||[];for(var g=0;g<this.items.length;g++){var h=this.items[g];h.uiName="listitem";h.index=g;h.onclick=function(){j.selectByIndex(this.index)}}this.popup=new f({items:this.items,uiName:"list"});this.initSplitButton()},_SplitButton_postRender:a.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.setLabel(this.label||"")},showPopup:function(){var g=d.getClientRect(this.getDom());g.top+=1;g.bottom-=1;g.height-=2;this.popup.showAnchorRect(g)},getValue:function(){return this.value},setValue:function(h){var g=this.indexByValue(h);if(g!=-1){this.selectedIndex=g;this.setLabel(this.items[g].label);this.value=this.items[g].value}else{this.selectedIndex=-1;this.setLabel(this.getLabelForUnknowValue(h));this.value=h}},setLabel:function(g){this.getDom("button_body").innerHTML=g;this.label=g},getLabelForUnknowValue:function(g){return g},indexByValue:function(h){for(var g=0;g<this.items.length;g++){if(h==this.items[g].value){return g}}return -1},getItem:function(g){return this.items[g]},selectByIndex:function(g){if(g<this.items.length&&this.fireEvent("select",g)!==false){this.selectedIndex=g;this.value=this.items[g].value;this.setLabel(this.items[g].label)}}};b.inherits(c,a)})();(function(){var h=baidu.editor.utils,d=baidu.editor.dom.domUtils,a=baidu.editor.ui.uiUtils,e=baidu.editor.ui.Mask,b=baidu.editor.ui.UIBase,f=baidu.editor.ui.Button,g=baidu.editor.ui.Dialog=function(j){this.initOptions(j);this.initDialog()};var c;var i;g.prototype={draggable:false,uiName:"dialog",initDialog:function(){var k=this;this.initUIBase();this.modalMask=(c||(c=new e({className:"edui-dialog-modalmask"})));this.dragMask=(i||(i=new e({className:"edui-dialog-dragmask"})));this.closeButton=new f({className:"edui-dialog-closebutton",title:"",onclick:function(){k.close(false)}});if(this.buttons){for(var j=0;j<this.buttons.length;j++){if(!(this.buttons[j] instanceof f)){this.buttons[j]=new f(this.buttons[j])}}}},fitSize:function(){var j=this.getDom("body");var k=this.mesureSize();j.style.width=k.width+"px";j.style.height=k.height+"px";return k},safeSetOffset:function(p){var l=this;var j=l.getDom();var o=a.getViewportRect();var k=a.getClientRect(j);var n=p.left;if(n+k.width>o.right){n=o.right-k.width}var m=p.top;if(m+k.height>o.bottom){m=o.bottom-k.height}j.style.left=Math.max(n,0)+"px";j.style.top=Math.max(m,0)+"px"},showAtCenter:function(){this.getDom().style.display="";var o=a.getViewportRect();var j=this.fitSize();var n=this.getDom("titlebar").offsetHeight|0;var m=o.width/2-j.width/2;var l=o.height/2-(j.height-n)/2-n;var k=this.getDom();this.safeSetOffset({left:Math.max(m|0,0),top:Math.max(l|0,0)});if(!d.hasClass(k,"edui-state-centered")){k.className+=" edui-state-centered"}this._show()},getContentHtml:function(){var j="";if(typeof this.content=="string"){j=this.content}else{if(this.iframeUrl){j='<iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>'}}return j},getHtmlTpl:function(){var k="";if(this.buttons){var l=[];for(var j=0;j<this.buttons.length;j++){l[j]=this.buttons[j].renderHtml()}k='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+l.join("")+"</div></div>"}return'<div id="##" class="%%"><div class="%%-wrap"><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+(this.title||"")+"</span></div>"+this.closeButton.renderHtml()+'</div><div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"</div>"+k+"</div></div></div>"},postRender:function(){if(!this.modalMask.getDom()){this.modalMask.render();this.modalMask.hide()}if(!this.dragMask.getDom()){this.dragMask.render();this.dragMask.hide()}var k=this;this.addListener("show",function(){k.modalMask.show()});this.addListener("hide",function(){k.modalMask.hide()});if(this.buttons){for(var j=0;j<this.buttons.length;j++){this.buttons[j].postRender()}}d.on(window,"resize",function(){setTimeout(function(){if(!k.isHidden()){k.safeSetOffset(a.getClientRect(k.getDom()))}})});this._hide()},mesureSize:function(){var j=this.getDom("body");var k=a.getClientRect(this.getDom("content")).width;var l=j.style;l.width=k;return a.getClientRect(j)},_onTitlebarMouseDown:function(j,k){if(this.draggable){var m;var n=a.getViewportRect();var l=this;a.startDrag(j,{ondragstart:function(){m=a.getClientRect(l.getDom());l.dragMask.show()},ondragmove:function(o,r){var q=m.left+o;var p=m.top+r;l.safeSetOffset({left:q,top:p})},ondragstop:function(){d.removeClasses(l.getDom(),["edui-state-centered"]);l.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml()},_show:function(){if(this._hidden){this.getDom().style.display="";this._hidden=false;this.fireEvent("show")}},isHidden:function(){return this._hidden},_hide:function(){if(!this._hidden){this.getDom().style.display="none";this._hidden=true;this.fireEvent("hide")}},open:function(){if(this.autoReset){this.reset()}this.showAtCenter();if(this.iframeUrl){try{this.getDom("iframe").focus()}catch(j){}}},_onCloseButtonClick:function(j,k){this.close(false)},close:function(j){if(this.fireEvent("close",j)!==false){this._hide()}}};h.inherits(g,b)})();(function(){var b=baidu.editor.utils,c=baidu.editor.ui.Menu,a=baidu.editor.ui.SplitButton,d=baidu.editor.ui.MenuButton=function(e){this.initOptions(e);this.initMenuButton()};d.prototype={initMenuButton:function(){var e=this;this.uiName="menubutton";this.popup=new c({items:e.items,className:e.className});this.initSplitButton()},setValue:function(g){var f=this.popup;for(var e=0;e<f.items.length;e++){f.items[e].removeState("checked");if(f.items[e].value==g){f.items[e].addState("checked");this.value=g}}}};b.inherits(d,a)})();(function(){var c=baidu.editor.utils,e=baidu.editor.ui.Mask,d=baidu.editor.ui.Popup,b=baidu.editor.ui.SplitButton,a=baidu.editor.ui.MultiMenuPop=function(f){this.initOptions(f);this.initMultiMenu()};a.prototype={initMultiMenu:function(){this.initSplitButton();var f=this;this.popup=new d({content:"",iframe_rendered:false,onshow:function(){if(!this.iframe_rendered){this.iframe_rendered=true;this.getDom("content").innerHTML='<iframe id="'+f.id+'_iframe" src="'+f.iframeUrl+'" frameborder="0"></iframe>'}}});this.onbuttonclick=function(){this.showPopup()}}};c.inherits(a,b)})();(function(){var a=baidu.editor.dom.domUtils;baidu.editor.plugins.contextmenu=function(){var d=this,e,b=d.options.contextMenu;var c=baidu.editor.ui.uiUtils;d.addListener("contextmenu",function(k,f){var m=c.getViewportOffsetByEvent(f);if(e){e.destroy()}for(var h=0,j,g=[];j=b[h];h++){var l;(function(p){if(p=="-"){if((l=g[g.length-1])&&l!=="-"){g.push("-")}}else{if(p.group){for(var o=0,n,i=[];n=p.subMenu[o];o++){(function(q){if(q=="-"){if((l=i[i.length-1])&&l!=="-"){i.push("-")}}else{if(d.queryCommandState(q.cmdName)!=-1){i.push({label:q.label,className:"edui-for-"+q.cmdName+(q.value||""),onclick:p.exec?function(){p.exec.call(d)}:function(){d.execCommand(q.cmdName,q.value)}})}}})(n)}if(i.length){g.push({label:p.group,className:"edui-for-"+p.icon,subMenu:{items:i}})}}else{if(d.queryCommandState(p.cmdName)!=-1){g.push({label:p.label,className:"edui-for-"+p.cmdName+(p.value||""),onclick:p.exec?function(){p.exec.call(d)}:function(){d.execCommand(p.cmdName,p.value)}})}}}})(j)}if(g[g.length-1]=="-"){g.pop()}e=new baidu.editor.ui.Menu({items:g});e.render();e.showAt(m);f.preventDefault?f.preventDefault():(f.returnValue=false)})}})();(function(){baidu.editor.plugins.video=function(){var d=this;var c={};var a=[];var e=0;function b(i,l,g,k){var h="edui_faked_video_"+(e++);var j='<img isfakedvideo id="'+h+'" width="'+l+'" height="'+g+'" _url="'+i+'" class="edui-faked-video" src="http://hi.baidu.com/fc/editor/images/spacer.gif" style="background:url(http://hi.baidu.com/ui/neweditor/lib/fck/images/fck_videologo.gif) no-repeat center center; border:1px solid gray;'+k+';" />';c[h]='<embed isfakedvideo type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+i+'" width="'+l+'" height="'+g+'" wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never"></embed>';return j}d.commands.insertvideo={execCommand:function(l,i){var h=i.url;var k=i.width||320;var g=i.height||240;var j=i.style?i.style:"";d.execCommand("inserthtml",b(h,k,g,j))}};function f(j,i){var h=new RegExp(i+":\\s*((\\w)*)","ig");var g=h.exec(j);return g?g[1]:""}d.addListener("beforegetcontent",function(){var j=d.document.createElement("div");var k={};for(var g in c){var l;while((l=d.document.getElementById(g))){j.innerHTML=c[g];var h=j.firstChild;h.width=l.width;h.height=l.height;var i=l.style.cssText;if(/float/ig.test(i)){if(!!window.ActiveXObject){h.style.styleFloat=f(i,"float")}else{h.style.cssFloat=f(i,"float")}}else{if(/display/ig.test(i)){h.style.display=f(i,"display")}}l.parentNode.replaceChild(h,l);a.push([l,h]);k[g]=c[g]}}c=k});d.addListener("aftersetcontent",function(){var n=d.document.createElement("div");c={};var l=d.document.getElementsByTagName("embed");var i=[];var m=l.length;while(m--){i[m]=l[m]}m=i.length;while(m--){var h=i[m].src;var j=i[m].width||320;var o=i[m].height||240;var p=i[m].style.cssText;var g=f(p,"display")?"display:"+f(p,"display"):"float:"+f(p,"float");n.innerHTML=b(h,j,o,g);i[m].parentNode.replaceChild(n.firstChild,i[m])}});d.addListener("aftergetcontent",function(){for(var g=0;g<a.length;g++){var h=a[g];h[1].parentNode.replaceChild(h[0],h[1])}a=[]})}})();(function(){var j=baidu.editor,f=j.browser,e=j.dom.domUtils,m=e.keys,c=e.clearSelectedArr;var l,d,h,g,k=e.isEmptyNode;function b(n){var o=n.parentNode.cells;for(var q=0,p;p=o[q];q++){if(p===n){return q}}}function i(n){return n.style.display=="none"}function a(n){var q=0;for(var o=0,p;p=n[o++];){if(!i(p)){q++}}return q}baidu.editor.plugins.table=function(){var t=this;t.currentSelectedArr=[];t.addListener("mousedown",n);t.addListener("keydown",function(w,v){var x=v.keyCode||v.which;if(!m[x]&&!v.ctrlKey&&!v.metaKey&&!v.shiftKey&&!v.altKey){c(t.currentSelectedArr)}});t.addListener("mouseup",function(y,w){l=null;t.removeListener("mouseover",n);var A=t.currentSelectedArr[0];if(A){t.document.body.style.webkitUserSelect="";var x=new baidu.editor.dom.Range(t.document);if(k(A)){x.setStart(t.currentSelectedArr[0],0).setCursor()}else{x.selectNodeContents(t.currentSelectedArr[0]).select()}}else{var x=t.selection.getRange().shrinkBoundary();if(!x.collapsed){var z=e.findParentByTagName(x.startContainer,"td",true),v=e.findParentByTagName(x.endContainer,"td",true);if(z&&!v||!z&&v||z&&v&&z!==v){x.collapse(true).select(true)}}}});function s(){t.currentSelectedArr=[];l=null}t.commands.inserttable={queryCommandState:function(){var v=this.selection.getRange();return e.findParentByTagName(v.startContainer,"table",true)||e.findParentByTagName(v.endContainer,"table",true)||t.currentSelectedArr.length>0?-1:0},execCommand:function(z,y){d=y;var v=[];v.push("cellpadding='"+(y.cellpadding||0)+"'");v.push("cellspacing='"+(y.cellspacing||0)+"'");y.width?v.push("width='"+y.width+"'"):v.push("width='500'");y.height?v.push("height='"+y.height+"'"):v.push("height='100'");h="vertical-align:top;padding:2px;border:"+(y.cellborder||1)+"px solid #000;width:"+Math.floor((y.width||500)/y.numCols)+"px;height:20px;text-align: "+(y.align||"left")+";";var A,B=[],x=y.numRows;if(x){while(x--){var C=[];var w=y.numCols;while(w--){C[w]='<td style="'+h+'">'+(f.ie?"":"<br/>")+"</td>"}B.push("<tr>"+C.join("")+"</tr>")}}A='<table _baidu_table="true" '+v.join(" ")+' style="margin-bottom:10px;'+(y.cellpadding||y.cellspacing?"":"border-collapse:collapse;")+"border:"+(y.border||1)+'px solid #000;">'+B.join("")+"</table>";this.execCommand("insertHtml",A);s()}};t.commands.deletetable={queryCommandState:function(){var v=this.selection.getRange();return(e.findParentByTagName(v.startContainer,"table",true)&&e.findParentByTagName(v.endContainer,"table",true))||t.currentSelectedArr.length>0?0:-1},execCommand:function(){var v=this.selection.getRange(),w=e.findParentByTagName(t.currentSelectedArr.length>0?t.currentSelectedArr[0]:v.startContainer,"table",true);var x=w.ownerDocument.createElement("p");x.innerHTML=f.ie?"&nbsp;":"<br/>";w.parentNode.insertBefore(x,w);e.remove(w);v.setStart(x,0).setCursor();e.remove(w);s()}};t.commands.settablestyle={queryCommandState:function(){var v=this.selection.getRange();return(e.findParentByTagName(v.startContainer,"table",true)&&e.findParentByTagName(v.endContainer,"table",true))||t.currentSelectedArr.length>0?0:-1},execCommand:function(x,w){var v=this.selection.getRange(),B=e.findParentByTagName(t.currentSelectedArr.length>0?t.currentSelectedArr[0]:v.startContainer,"table",true),A=B.style.cssText;var z=typeof(w)=="function"?w():w;for(var y in z){if(y=="border-spacing"){B.cellSpacing=z[y];continue}if(y=="width"){B.width=z[y];continue}if(y=="background"){B.bgColor=z[y];continue}A+=y+":"+z[y]+";"}B.style.cssText=A}};t.commands.addcaption={queryCommandState:function(){var v=this.selection.getRange();return(e.findParentByTagName(v.startContainer,"table",true)&&e.findParentByTagName(v.endContainer,"table",true))||t.currentSelectedArr.length>0?0:-1},execCommand:function(w,x){var v=this.selection.getRange(),y=e.findParentByTagName(t.currentSelectedArr.length>0?t.currentSelectedArr[0]:v.startContainer,"table",true);if(x=="on"){var z=y.createCaption();z.innerHTML=""}else{y.removeChild(y.caption)}}};t.commands.mergeright={queryCommandState:function(){var v=this.selection.getRange(),A=v.startContainer,z=e.findParentByTagName(A,["td","th"],true);if(!z||this.currentSelectedArr.length>1){return -1}var y=z.parentNode;var w=b(z)+z.colSpan;if(w>=y.cells.length){return -1}var x=y.cells[w];if(i(x)){return -1}return z.rowSpan==x.rowSpan?0:-1},execCommand:function(){var B=this.selection.getRange(),v=B.startContainer,w=e.findParentByTagName(v,["td","th"],true)||t.currentSelectedArr[0],C=w.parentNode,F=C.parentNode.parentNode.rows;var y=C.rowIndex,E=b(w)+w.colSpan,A=F[y].cells[E];for(var z=y;z<y+A.rowSpan;z++){for(var x=E;x<E+A.colSpan;x++){var D=F[z].cells[x];D.setAttribute("rootRowIndex",C.rowIndex);D.setAttribute("rootCellIndex",b(w))}}w.colSpan+=A.colSpan||1;q(w,A);A.style.display="none";B.setStart(w,0).setCursor()}};t.commands.mergedown={queryCommandState:function(){var w=this.selection.getRange(),C=w.startContainer,B=e.findParentByTagName(C,"td",true);if(!B||a(t.currentSelectedArr)>1){return -1}var A=B.parentNode,y=A.parentNode.parentNode,z=y.rows;var x=A.rowIndex+B.rowSpan;if(x>=z.length){return -1}var v=z[x].cells[b(B)];if(i(v)){return -1}return B.colSpan==v.colSpan?0:-1},execCommand:function(){var B=this.selection.getRange(),v=B.startContainer,x=e.findParentByTagName(v,["td","th"],true)||t.currentSelectedArr[0];var D=x.parentNode,F=D.parentNode.parentNode.rows;var w=D.rowIndex+x.rowSpan,C=b(x),z=F[w].cells[C];for(var A=w;A<w+z.rowSpan;A++){for(var y=C;y<C+z.colSpan;y++){var E=F[A].cells[y];E.setAttribute("rootRowIndex",D.rowIndex);E.setAttribute("rootCellIndex",b(x))}}x.rowSpan+=z.rowSpan||1;q(x,z);z.style.display="none";B.setStart(x,0).setCursor()}};t.commands.deleterow={queryCommandState:function(){var v=this.selection.getRange(),x=v.startContainer,w=e.findParentByTagName(x,["td","th"],true);if(!w&&t.currentSelectedArr.length==0){return -1}},execCommand:function(){var G=this.selection.getRange(),z=G.startContainer,B=e.findParentByTagName(z,["td","th"],true),v,M,y,D,E,C;if(B&&t.currentSelectedArr.length==0){var A=(B.rowSpan||1)-1;t.currentSelectedArr.push(B);v=B.parentNode,M=v.parentNode.parentNode;D=M.rows,E=v.rowIndex+1,C=b(B);while(A){t.currentSelectedArr.push(D[E].cells[C]);A--;E++}}while(B=t.currentSelectedArr.pop()){if(!e.findParentByTagName(B,"table")){continue}v=B.parentNode,M=v.parentNode.parentNode;y=v.cells,D=M.rows,E=v.rowIndex,C=b(B);for(var F=0;F<y.length;){var x=y[F];if(i(x)){var w=D[x.getAttribute("rootRowIndex")].cells[x.getAttribute("rootCellIndex")];w.rowSpan--;F+=w.colSpan}else{if(x.rowSpan==1){F+=x.colSpan}else{var K=D[E+1].cells[F];K.style.display="";K.rowSpan=x.rowSpan-1;K.colSpan=x.colSpan;F+=x.colSpan}}}e.remove(v);var N,I,L;if(E==D.length){if(E==0){var H=M.ownerDocument.createElement("p");H.innerHTML=f.ie?"&nbsp;":"<br/>";M.parentNode.insertBefore(H,M);e.remove(M);G.setStart(H,0).setCursor();return}var J=E-1;N=D[J].cells[C];I=i(N)?D[N.getAttribute("rootRowIndex")].cells[N.getAttribute("rootCellIndex")]:N}else{L=D[E].cells[C];I=i(L)?D[L.getAttribute("rootRowIndex")].cells[L.getAttribute("rootCellIndex")]:L}}G.setStart(I,0).setCursor();u(M)}};t.commands.deletecol={queryCommandState:function(){var v=this.selection.getRange(),x=v.startContainer,w=e.findParentByTagName(x,["td","th"],true);if(!w&&t.currentSelectedArr.length==0){return -1}},execCommand:function(){var H=this.selection.getRange(),z=H.startContainer,C=e.findParentByTagName(z,["td","th"],true);if(C&&t.currentSelectedArr.length==0){var B=(C.colSpan||1)-1;t.currentSelectedArr.push(C);while(B){do{C=C.nextSibling}while(C.nodeType==3);t.currentSelectedArr.push(C);B--}}while(C=t.currentSelectedArr.pop()){if(!e.findParentByTagName(C,"table")){continue}var v=C.parentNode,M=v.parentNode.parentNode,E=b(C),F=M.rows,x=v.cells,G=v.rowIndex;var y;for(var R=0;R<F.length;){var w=F[R].cells[E];if(i(w)){var N=F[w.getAttribute("rootRowIndex")].cells[w.getAttribute("rootCellIndex")];y=N.rowSpan;for(var L=0;L<N.rowSpan;L++){var P=F[R+L].cells[E];e.remove(P)}N.colSpan--;R+=y}else{if(w.colSpan==1){y=w.rowSpan;for(var L=R,K=R+w.rowSpan;L<K;L++){e.remove(F[L].cells[E])}R+=y}else{var A=F[R].cells[E+1];A.style.display="";A.rowSpan=w.rowSpan;A.colSpan=w.colSpan-1;R+=w.rowSpan;e.remove(w)}}}var Q,J,O;if(E==x.length){if(E==0){var I=M.ownerDocument.createElement("p");I.innerHTML=f.ie?"&nbsp;":"<br/>";M.parentNode.insertBefore(I,M);e.remove(M);H.setStart(I,0).setCursor();return}var D=E-1;Q=F[G].cells[D];J=i(Q)?F[Q.getAttribute("rootRowIndex")].cells[Q.getAttribute("rootCellIndex")]:Q}else{O=F[G].cells[E];J=i(O)?F[O.getAttribute("rootRowIndex")].cells[O.getAttribute("rootCellIndex")]:O}}H.setStart(J,0).setCursor();u(M)}};t.commands.splittocells={queryCommandState:function(){var v=this.selection.getRange(),x=v.startContainer,w=e.findParentByTagName(x,["td","th"],true);return w&&(w.rowSpan>1||w.colSpan>1)&&(!t.currentSelectedArr.length||a(t.currentSelectedArr)==1)?0:-1},execCommand:function(){var z=this.selection.getRange(),v=z.startContainer,w=e.findParentByTagName(v,["td","th"],true),B=w.parentNode,G=B.parentNode.parentNode;var E=B.rowIndex,D=b(w),C=w.rowSpan,A=w.colSpan;for(var y=0;y<C;y++){for(var x=0;x<A;x++){var F=G.rows[E+y].cells[D+x];F.rowSpan=1;F.colSpan=1;if(i(F)){F.style.display="";F.innerHTML=f.ie?"":"<br/>"}}}}};t.commands.splittorows={queryCommandState:function(){var v=this.selection.getRange(),x=v.startContainer,w=e.findParentByTagName(x,"td",true)||t.currentSelectedArr[0];return w&&(w.rowSpan>1)&&(!t.currentSelectedArr.length||a(t.currentSelectedArr)==1)?0:-1},execCommand:function(){var z=this.selection.getRange(),v=z.startContainer,w=e.findParentByTagName(v,"td",true)||t.currentSelectedArr[0],B=w.parentNode,H=B.parentNode.parentNode.rows;var E=B.rowIndex,D=b(w),C=w.rowSpan,A=w.colSpan;for(var y=0;y<C;y++){var G=H[E+y],F=G.cells[D];F.rowSpan=1;F.colSpan=A;if(i(F)){F.style.display="";F.innerHTML=f.ie?"":"<br/>"}for(var x=D+1;x<D+A;x++){F=G.cells[x];F.setAttribute("rootRowIndex",E+y)}}c(t.currentSelectedArr);this.selection.getRange().setStart(w,0).setCursor()}};t.commands.insertparagraphbeforetable={queryCommandState:function(){var v=this.selection.getRange(),x=v.startContainer,w=e.findParentByTagName(x,"td",true)||t.currentSelectedArr[0];return w&&e.findParentByTagName(w,"table")?0:-1},execCommand:function(){var v=this.selection.getRange(),x=v.startContainer,w=e.findParentByTagName(x,"table",true);x=t.document.createElement(t.options.enterTag);w.parentNode.insertBefore(x,w);c(t.currentSelectedArr);if(x.tagName=="P"){x.innerHTML=f.ie?"":"<br/>";v.setStart(x,0)}else{v.setStartBefore(x)}v.setCursor()}};t.commands.splittocols={queryCommandState:function(){var v=this.selection.getRange(),x=v.startContainer,w=e.findParentByTagName(x,["td","th"],true)||t.currentSelectedArr[0];return w&&(w.colSpan>1)&&(!t.currentSelectedArr.length||a(t.currentSelectedArr)==1)?0:-1},execCommand:function(){var z=this.selection.getRange(),v=z.startContainer,w=e.findParentByTagName(v,["td","th"],true)||t.currentSelectedArr[0],B=w.parentNode,H=B.parentNode.parentNode.rows;var E=B.rowIndex,D=b(w),C=w.rowSpan,A=w.colSpan;for(var y=0;y<A;y++){var G=H[E].cells[D+y];G.rowSpan=C;G.colSpan=1;if(i(G)){G.style.display="";G.innerHTML=f.ie?"":"<br/>"}for(var x=E+1;x<E+C;x++){var F=H[x].cells[D+y];F.setAttribute("rootCellIndex",D+y)}}c(t.currentSelectedArr);this.selection.getRange().setStart(w,0).setCursor()}};t.commands.insertrow={queryCommandState:function(){var v=this.selection.getRange();return e.findParentByTagName(v.startContainer,"table",true)||e.findParentByTagName(v.endContainer,"table",true)||t.currentSelectedArr.length!=0?0:-1},execCommand:function(){var A=this.selection.getRange(),v=A.startContainer,C=e.findParentByTagName(v,"tr",true)||t.currentSelectedArr[0].parentNode,F=C.parentNode.parentNode,I=F.rows;var D=C.rowIndex,G=I[D].cells;var H=F.insertRow(D);var y;for(var B=0;B<G.length;){var E=G[B];if(i(E)){var z=I[E.getAttribute("rootRowIndex")].cells[E.getAttribute("rootCellIndex")];z.rowSpan++;for(var x=0;x<z.colSpan;x++){y=E.cloneNode(false);y.rowSpan=y.colSpan=1;y.innerHTML=f.ie?"":"<br/>";y.className="";if(H.children[B+x]){H.insertBefore(y,H.children[B+x])}else{H.appendChild(y)}y.style.display="none"}B+=z.colSpan}else{for(var w=0;w<E.colSpan;w++){y=E.cloneNode(false);y.rowSpan=y.colSpan=1;y.innerHTML=f.ie?"":"<br/>";y.className="";if(H.children[B+w]){H.insertBefore(y,H.children[B+w])}else{H.appendChild(y)}}B+=E.colSpan}}u(F);A.setStart(H.cells[0],0).setCursor();c(t.currentSelectedArr)}};t.commands.insertcol={queryCommandState:function(){var v=this.selection.getRange();return e.findParentByTagName(v.startContainer,"table",true)||e.findParentByTagName(v.endContainer,"table",true)||t.currentSelectedArr.length!=0?0:-1},execCommand:function(){var A=this.selection.getRange(),v=A.startContainer,w=e.findParentByTagName(v,["td","th"],true)||t.currentSelectedArr[0],G=e.findParentByTagName(w,"table"),H=G.rows;var C=b(w),z;for(var E=0;E<H.length;){var F=H[E].cells[C],B;if(i(F)){var D=H[F.getAttribute("rootRowIndex")].cells[F.getAttribute("rootCellIndex")];D.colSpan++;for(var y=0;y<D.rowSpan;y++){z=w.cloneNode(false);z.rowSpan=z.colSpan=1;z.innerHTML=f.ie?"":"<br/>";z.className="";B=H[E+y];if(B.children[C]){B.insertBefore(z,B.children[C])}else{B.appendChild(z)}z.style.display="none"}E+=D.rowSpan}else{for(var x=0;x<F.rowSpan;x++){z=w.cloneNode(false);z.rowSpan=z.colSpan=1;z.innerHTML=f.ie?"":"<br/>";z.className="";B=H[E+x];if(B.children[C]){B.insertBefore(z,B.children[C])}else{B.appendChild(z)}z.innerHTML=f.ie?"":"<br/>"}E+=F.rowSpan}}u(G);A.setStart(H[0].cells[C],0).setCursor();c(t.currentSelectedArr)}};t.commands.mergecells={queryCommandState:function(){var x=0;for(var v=0,w;w=this.currentSelectedArr[v++];){if(!i(w)){x++}}return x>1?0:-1},execCommand:function(){var w=t.currentSelectedArr[0],z=t.currentSelectedArr[t.currentSelectedArr.length-1],G=e.findParentByTagName(w,"table"),I=G.rows,v={beginRowIndex:w.parentNode.rowIndex,beginCellIndex:b(w),endRowIndex:z.parentNode.rowIndex,endCellIndex:b(z)},F=v.beginRowIndex,y=v.beginCellIndex,x=v.endRowIndex-v.beginRowIndex+1,E=v.endCellIndex-v.beginCellIndex+1,C=I[F].cells[y];for(var B=0,D;(D=I[F+B++])&&B<=x;){for(var A=0,H;(H=D.cells[y+A++])&&A<=E;){if(B==1&&A==1){H.style.display="";H.rowSpan=x;H.colSpan=E}else{H.style.display="none";H.rowSpan=1;H.colSpan=1;H.setAttribute("rootRowIndex",F);H.setAttribute("rootCellIndex",y);q(C,H)}}}this.selection.getRange().setStart(C,0).setCursor();c(t.currentSelectedArr)}};function q(w,v){if(k(v)){return}if(k(w)){w.innerHTML=v.innerHTML;return}var x=w.lastChild;if(x.nodeType!=1||x.tagName!="BR"){w.appendChild(w.ownerDocument.createElement("br"))}while(x=v.firstChild){w.appendChild(x)}}function p(z,y){var I=z.parentNode,H=y.parentNode,J=I.rowIndex,x=H.rowIndex,F=I.parentNode.parentNode.rows,S=F.length,w=F[0].cells.length,M=b(z),T=b(y);if(z==y){return{beginRowIndex:J,beginCellIndex:M,endRowIndex:J+z.rowSpan-1,endCellIndex:T+z.colSpan-1}}var O=Math.min(J,x),G=Math.min(M,T),v=Math.max(J+z.rowSpan-1,x+y.rowSpan-1),N=Math.max(M+z.colSpan-1,T+y.colSpan-1);while(1){var L=O,Q=G,R=v,C=N;if(O>0){for(D=G;D<=N;){var A=F[O].cells[D];if(i(A)){O=A.getAttribute("rootRowIndex");A=F[A.getAttribute("rootRowIndex")].cells[A.getAttribute("rootCellIndex")]}D=b(A)+(A.colSpan||1)}}if(G>0){for(var E=O;E<=v;){var P=F[E].cells[G];if(i(P)){G=P.getAttribute("rootCellIndex");P=F[P.getAttribute("rootRowIndex")].cells[P.getAttribute("rootCellIndex")]}E=P.parentNode.rowIndex+(P.rowSpan||1)}}if(v<S){for(var D=G;D<=N;){var B=F[v].cells[D];if(i(B)){B=F[B.getAttribute("rootRowIndex")].cells[B.getAttribute("rootCellIndex")]}v=B.parentNode.rowIndex+B.rowSpan-1;D=b(B)+(B.colSpan||1)}}if(N<w){for(E=O;E<=v;){var K=F[E].cells[N];if(i(K)){K=F[K.getAttribute("rootRowIndex")].cells[K.getAttribute("rootCellIndex")]}N=b(K)+K.colSpan-1;E=K.parentNode.rowIndex+(K.rowSpan||1)}}if(Q==G&&C==N&&R==v&&L==O){break}}return{beginRowIndex:O,beginCellIndex:G,endRowIndex:v,endCellIndex:N}}function n(w,v){if(v.button==2){return}t.document.body.style.webkitUserSelect="";l=v.target||v.srcElement;c(t.currentSelectedArr);e.clearSelectedArr(t.currentSelectedArr);if(l.tagName!=="TD"){l=e.findParentByTagName(l,"td")||l}if(l.tagName=="TD"){t.addListener("mouseover",function(y,x){var z=x.target||x.srcElement;o.call(t,z);x.preventDefault?x.preventDefault():(x.returnValue=false)})}else{s()}}function o(x){if(l&&x.tagName=="TD"){t.document.body.style.webkitUserSelect="none";var w=x.parentNode.parentNode.parentNode;t.selection.getNative()[f.ie?"empty":"removeAllRanges"]();var v=p(l,x);r(w,v)}}function r(y,x){var z=y.rows;c(t.currentSelectedArr);for(var w=x.beginRowIndex;w<=x.endRowIndex;w++){for(var v=x.beginCellIndex;v<=x.endCellIndex;v++){var A=z[w].cells[v];A.className=t.options.selectedTdClass;t.currentSelectedArr.push(A)}}}function u(D){var z=D.getElementsByTagName("td"),C,B,E=D.rows;for(var x=0,w;w=z[x++];){if(!i(w)){C=w.parentNode.rowIndex;B=b(w);for(var v=0;v<w.rowSpan;v++){var A=v==0?1:0;for(;A<w.colSpan;A++){var y=E[C+v].children[B+A];y.setAttribute("rootRowIndex",C);y.setAttribute("rootCellIndex",B)}}}}}t.adjustTable=function(J){var H=J.getElementsByTagName("table");for(var C=0,x;x=H[C++];){var G=x.getAttribute("_baidu_table");!G&&(x.style.cssText=x.style.cssText+";margin-bottom:10px;border-collapse:collapse;border:1px solid #000;");var B=e.getElementsByTagName(x,"td"),z,y;for(var A=0,w;w=B[A++];){!G&&(w.style.cssText=w.style.cssText+";vertical-align:top;padding:2px;border:1px solid #000;");var D=b(w),F=w.parentNode.rowIndex,I=e.findParentByTagName(w,"table").rows;for(var v=0;v<w.rowSpan;v++){var E=v==0?1:0;for(;E<w.colSpan;E++){if(!z){z=w.cloneNode(false);z.rowSpan=z.colSpan=1;z.style.display="none";z.innerHTML=f.ie?"":"<br/>"}else{z=z.cloneNode(true)}z.setAttribute("rootRowIndex",w.parentNode.rowIndex);z.setAttribute("rootCellIndex",D);if(v==0){if(w.nextSibling){w.parentNode.insertBefore(z,w.nextSibling)}else{w.parentNode.appendChild(z)}}else{y=I[F+v].children[D];if(y){y.parentNode.insertBefore(z,y)}else{I[F+v].appendChild(z)}}}}}}}}})();