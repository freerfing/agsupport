// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.26/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/tooltip/GridCellTooltipBuilder","dojo/_base/declare ../GridDataUtil ../../../supportClasses/conditionalStyling/ConditionalStyleLegendBuilder ../../valueField/utils/ValueFieldTextTrimmer ./_ScriptExpressionBuilder esri/dijit/geoenrichment/utils/ObjectUtil esri/dijit/geoenrichment/utils/TooltipUtil esri/dijit/geoenrichment/ReportPlayer/config dojo/i18n!esri/nls/jsapi".split(" "),function(m,k,q,r,t,u,v,n,e){e=e.geoenrichment.dijit.ReportPlayer.Grid;
var w=m(null,{_content:"",getContent:function(){return this._content?"\x3cdiv class\x3d'esriGEAdjustableGridValueField_cellTooltipContent'\x3e"+this._content+"\x3c/div\x3e":null},addValue:function(a){this._content+="\x3cdiv class\x3d'esriGERowHigh esriGEAdjustableGridValueField_cellTooltipContentValue'\x3e"+a+"\x3c/div\x3e"},addImageValue:function(a){isNaN(a.currentNumberValue)||"number"!==typeof a.currentNumberValue||(a=a.numberFormatFunction?a.numberFormatFunction(a.currentNumberValue):u.formatNumber(a.currentNumberValue),
this._content+="\x3cdiv class\x3d'esriGERowHigh esriGEAdjustableGridValueField_cellTooltipContentValue'\x3e"+a+"\x3c/div\x3e")},addAlias:function(a){this._content+="\x3cdiv class\x3d'esriGERowHigh'\x3e\x3cb\x3e"+e.variable+"\x3c/b\x3e "+a+"\x3c/div\x3e"},addExpression:function(a,g,b){if(a=t.buildTooltipExpression(a,g))this._content+="\x3cdiv class\x3d'esriGERowHigh'\x3e"+e.variableIsBasedOnExpression+"\x3c/div\x3e",this._content+="\x3cdiv class\x3d'esriGERowHigh'\x3e"+a+"\x3c/div\x3e"},addConditionalStyleLegend:function(a){var g=
k.getConditionalFormatting(a),b=k.getFieldInfo(a).isImage;this._content+=q.createLegendNode(g,b?"image":"text",a.currentNumberValue).outerHTML},addTextBlock:function(a){this._content+="\x3cdiv class\x3d'esriGERowHigh'\x3e"+a+"\x3c/div\x3e"}}),x=/<\w/,l={setDynamicTooltipToCell:function(a,g,b){var c=k.getFieldInfo(a);(a.hasOverflowText()||c&&(c.hasVariable||c.script))&&a.own(v.setTooltipToNode(a.domNode,function(){return l.renderCellTooltip(a,g,b)},{classes:"esriGEAdjustableGridValueField_cellTooltip",
stayOnHover:c&&(c.script||c.expressionText)}))},renderCellTooltip:function(a,g,b){b=b||{};var c=b.getExpressionText||function(a){return n.modules.complexCellTooltips&&a.expressionText},e=r.getFullText(a),h=k.getConditionalFormatting(a),d=k.getFieldInfo(a),l=d&&(d.hasVariable||d.script),p=d&&d.isImage,m=d&&d.isRichText||e&&x.test(e),f=new w;!e||m||p||b.hideValue||f.addValue(e);l?(f.addAlias(d.script?d.script.alias:d.alias),(c=c(d))&&f.addExpression(c,g,b.makeExpressionExpandable)):p&&h&&h.fieldInfo&&
(!b.hideValue&&f.addImageValue(a),f.addAlias(h.fieldInfo.script?h.fieldInfo.script.alias:h.fieldInfo.alias),(c=c(h.fieldInfo))&&f.addExpression(c,g,b.makeExpressionExpandable));h&&n.modules.complexCellTooltips&&(b.conditionalLegendDesc&&f.addTextBlock(b.conditionalLegendDesc),f.addConditionalStyleLegend(a));return f.getContent()}};return l});