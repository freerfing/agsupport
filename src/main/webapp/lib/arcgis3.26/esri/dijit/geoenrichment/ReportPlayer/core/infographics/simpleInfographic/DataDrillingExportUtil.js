// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.26/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/infographics/simpleInfographic/DataDrillingExportUtil","dojo/_base/lang dojo/when dojo/dom-construct esri/dijit/geoenrichment/ReportPlayer/ReportPlayer esri/dijit/geoenrichment/ReportPlayer/PlayerResizeModes esri/dijit/geoenrichment/ReportPlayer/PlayerThemes esri/dijit/geoenrichment/ReportPlayer/DataProviderGE esri/dijit/geoenrichment/ReportPlayer/PlayerCommands ../../reportContainerGrid/utils/PageQueryUtil ../../supportClasses/templateJsonUtils/BlankTemplateJsonUtil ../../supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder esri/dijit/geoenrichment/utils/WaitingUtil".split(" "),
function(n,l,g,p,q,r,t,d,h,u,v,m){var c={reportPlayerClass:p,dataProviderClass:t,initPlayer:function(){var a=g.create("div",{"class":"esriGEAbsoluteStretched esriGEOffscreen"},document.body),b=new c.dataProviderClass;b.registerCommand(d.PRINT);b.registerCommand(d.IMAGE);b=(new c.reportPlayerClass({theme:r.DARK,dataProvider:b,resizeMode:q.FIT_WINDOW,isDataDrillingPlayer:!0})).placeAt(a);b.__playerDiv=a;return b},destroyPlayer:function(a){a.destroy();g.destroy(a.__playerDiv)}},b={},k=!1;b.setReportPlayerClass=
function(a){c.reportPlayerClass=a};b.setDataProviderClass=function(a){c.dataProviderClass=a};b.canPrintDataDrilling=function(a){return h.getParentReportPlayer(a).config.dataDrilling.canPrint};b.canExportDataDrilling=function(a){a=h.getParentReportPlayer(a);return a.config.dataDrilling.canExport?(a=a.dataProvider.getCommandById(d.IMAGE))&&a.isBrowserSupported():!1};b.printDataDrilling=function(a){b._createTemporaryPlayerAndExport(a,!0)};b.exportDataDrilling=function(a){b._createTemporaryPlayerAndExport(a,
!1)};b._createTemporaryPlayerAndExport=function(a,d){if(!k){k=!0;var e=h.getParentReportPlayer(a),g=e.getReportData(),e=e.dataProvider.reportDataToSingleAreaReportData(g,{currentFeatureIndex:a.currentFeatureIndex||0,reportTitle:e.getReportTitle(),templateJson:function(){var b=a._getDataDrillingPanelDimensions(),b=u.createBlankTemplate({elementWidth:b.w,elementHeight:b.h,layout:{numRows:1,numColumns:1}});b.theme=n.clone(a.theme);delete b.theme.document.backgroundImage;var c=a._drillingSections[0].toJson(),
c=v.createFieldInfoFromSection(c),d=b.sectionsTables[0].data;d.data[0].fieldInfos[d.columns[0].field]=c;return b}()}),f=c.initPlayer();f.onCommandSettingsShown=function(c){m.showProgressPromise(a.dataDrillingViewDiv,c);b.unitTesting_onCommandSettingsShown()};f.onCommandStart=function(b){m.showProgressPromise(a.dataDrillingViewDiv,b)};l(f.setReportData(e,{waitUntilAllContentIsReady:!0,disableAnimation:!0}),function(){return l(f[d?"executePrint":"executeExport"](),function(a){c.destroyPlayer(f);b.unitTesting_onExportCommandFinished(a)})}).always(function(){k=
!1})}};b.unitTesting_onCommandSettingsShown=function(){};b.unitTesting_onExportCommandFinished=function(a){};return b});