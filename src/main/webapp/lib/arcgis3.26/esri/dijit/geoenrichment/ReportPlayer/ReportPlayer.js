// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.26/esri/copyright.txt for details.
//>>built
require({cache:{"url:esri/dijit/geoenrichment/ReportPlayer/templates/ReportPlayer.html":'\x3cdiv class\x3d"esriGEReportPlayer esriGENonSelectable"\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"printBackgroundView" class\x3d"esriGEAbsoluteStretched"\x3e\x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"normalViewDiv"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"playerToolbarDiv"\x3e\x3c/div\x3e\r\n\r\n        \x3cdiv data-dojo-attach-point\x3d"printableDivContainer" class\x3d"reportPalyer_printableDivContainer"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"printableDiv" class\x3d"reportPalyer_printableDiv"\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"reportContainerDiv"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"reportPlayer_sidePageNavigator" data-dojo-attach-point\x3d"sidePageNavigator"\x3e\r\n            \x3cdiv class\x3d"reportPlayer_paginationArrowUp" data-dojo-attach-point\x3d"prevPageButton"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"reportPlayer_paginationArrowDown" data-dojo-attach-point\x3d"nextPageButton"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv data-dojo-attach-point\x3d"playerAfterToolbarDiv" class\x3d"reportPlayer_playerAfterToolbarDiv"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"errorViewDiv" class\x3d"esriGEReportPlayerErrorMessage"\x3e\r\n        ${nls.cantPlayReportError}\r\n    \x3c/div\x3e\r\n\x3c/div\x3e'}});
define("esri/dijit/geoenrichment/ReportPlayer/ReportPlayer","dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/dom-class dojo/when dijit/_WidgetBase dijit/_TemplatedMixin ./config ./playerSupports/_CommandSupport ./playerSupports/_KeyboardSwipeNavigationSupport ./playerSupports/_LogoSupport ./playerSupports/_MapSupport ./playerSupports/_PageNavigationSupport ./playerSupports/_PrintSupport ./playerSupports/_ReportContainersSwitcher ./playerSupports/_SmartLayoutSupport ./playerSupports/_ZoomSupport ./playerSupports/_WaitingSupport ./supportClasses/PlayerConfigurator ./supportClasses/PlayerToFullScreenAnimator ./printing/PageOptionsDialog/PageOptionsDialog ./PlayerToolbar ./ReportPlayerViewModel ./PlayerResizeModes ./PlayerThemes ./ReportPlayerState ./DataProviderGE esri/dijit/geoenrichment/utils/DelayUtil esri/dijit/geoenrichment/utils/DeviceUtil esri/dijit/geoenrichment/utils/DomUtil esri/dijit/geoenrichment/utils/async/AsyncQueue dojo/text!./templates/ReportPlayer.html dojo/i18n!esri/nls/jsapi ./_devConfig".split(" "),
function(t,h,u,f,d,v,w,x,y,z,A,B,C,D,E,F,G,H,I,n,J,K,L,l,M,p,N,m,q,g,O,P,k,Q){k=k.geoenrichment.dijit.ReportPlayer.ReportPlayer;return t([v,w,y,A,B,D,E,F,G,z,C,H],{templateString:P,nls:k,dataProvider:null,exportCommands:null,config:null,theme:void 0,viewMode:void 0,enableDataDrilling:void 0,showToolbarInPopup:void 0,showAreaTitle:void 0,scaleSlidesToFitWindow:void 0,showCloseButton:!1,showToFullScreenAnimation:!1,allowKeyboardNavigation:void 0,allowSwipeNavigation:void 0,resizeMode:void 0,renderMapsFromCalculators:!1,
printConfig:{subtitle:k.preparedByEsri,printDialogClass:J},showProgressBar:!0,defaultZoomBehavior:void 0,isDataDrillingPlayer:!1,_viewModel:null,_reportData:null,_analysisAreaIndex:0,_disableAnimation:!1,playerToolbar:null,postCreate:function(){this.config=h.mixin({},x,this.config);this._viewModel=new (this._getViewModelClass());this.dataProvider=this.dataProvider||new N;this.exportCommands&&this.exportCommands.forEach(function(a){this.dataProvider.registerCommand(a)},this);I.configurePlayer(this);
this._initToolbar();this._initContainerSwither();this._initSmartLayout();this._initCommands();this._initPageNavigationControls();this._initKeyboardSwipeNavigation();this._initZoomControls();this._applyTheme();this._showError(!1);this._initProgressController();f[q.isMobileDevice()?"add":"remove"](this.domNode,"esriGEReportPlayerMobile")},_getViewModelClass:function(){return L},_initToolbar:function(){var a=this;this.playerToolbar=(new K({popupButtonDiv:this.playerAfterToolbarDiv,showToolbarInPopup:this.showToolbarInPopup,
showAreaTitle:this.showAreaTitle,stretchToolbarNode:!this.showToolbarInPopup&&(this.resizeMode===l.FIT_WINDOW?document.body:this.domNode),showCloseButton:this.showCloseButton,isMobileDevice:q.isMobileDevice(),isScrollShown:function(){var b=a.getCurrentReportContainer();return b&&b.isScrollShown&&b.isScrollShown()},onClose:function(){a._onClose()}})).placeAt(this.playerToolbarDiv);this.own(this.playerToolbar);this.playerToolbar.onShowAnalysisAreaAt=function(b){a.showAnalysisAreaAt(b)}},_applyTheme:function(){f.remove(this.domNode,
"playerThemeDark playerThemeLight");f.add(this.domNode,this.theme===M.DARK?"playerThemeDark":"playerThemeLight");this.playerToolbar.setTheme(this.theme)},playReport:function(a,b){if(this.isContentLoading())return this.isContentLoading();var c=this;this._showError(!1);this._progressController&&this._progressController.reset();this.showToFullScreenAnimation&&this.resizeMode===l.FIT_WINDOW&&n.animateTo(this);this.dataProvider._onCreateReportStarted=function(){c._viewModel.preInitialize()};return d(this._showWaiting(this.dataProvider.getReportData(a,
function(a){c._progressController&&c._progressController.setLoadDataProgress(a)})),function(a){return c.setReportData(a,b)},function(a){c._showError(a)})},_isDataBeingSetFlag:!1,setReportData:function(a,b){if(this.isContentLoading())return this.isContentLoading();var c=this;b=b||{};if(this._reportData=a){b.disableAnimation&&(this._disableAnimation=!0);this._isDataBeingSetFlag=!0;p.isAnimationSuspended=!0;this.onSetReportDataStart();var e=new u;this._configureViewModel(a);m.delay(0).then(function(){if(1===
a.analysisAreas.length||a.isMultiFeature)this._destroyAllContainers(),this._resetMapBuilder(),this._applyReportData({analysisAreaIndex:0,rerenderContent:!0}).then(e.resolve,e.reject);else{var r=function(){0>d?e.resolve():c._applyReportData({analysisAreaIndex:d--,rerenderContent:!1}).then(function(){setTimeout(r,100)},e.reject)};!1!==b._resetLoadedContents&&(this._destroyAllContainers(),this._resetMapBuilder());var d=a.analysisAreas.length-1;r()}}.bind(this));this._progressController&&this._progressController.setNumAreas(a.analysisAreas.length);
this._progressController&&this._progressController.setLoadDataProgress(1);var d=e.promise.then(function(){return c._progressController&&c._progressController.finalize()}).otherwise(function(a){c._showError(a)});this._showWaiting(d);return d.always(function(){var a=c.getCurrentReportContainer();if(a&&a.domNode)return f.add(a.domNode,"esriGEReportPlayer_fadeIn1000"),m.delay(1E3).then(function(){a.domNode&&f.remove(a.domNode,"esriGEReportPlayer_fadeIn1000")}),m.delay(300).then(function(){c._isDataBeingSetFlag=
!1;p.isAnimationSuspended=!1;c.onSetReportDataEnd();c._emitPendingResizedEvent();a.notifyShown();c._progressController&&c._progressController.reset();if(b.waitUntilAllContentIsReady)return c.isContentLoading()})})}this._showError(!0)},refresh:function(a){return this.isContentLoading()?this.isContentLoading():this._reportData&&d(this.setReportData(this._reportData,{waitUntilAllContentIsReady:!(!a||!a.waitUntilAllContentIsReady),_resetLoadedContents:!(!a||!a.rerenderContent)}),function(){this.showPageAt(0);
return this.resize()}.bind(this))},showAnalysisAreaAt:function(a,b){if(this.isContentLoading())return this.isContentLoading();a=this._applyReportData({analysisAreaIndex:a,rerenderContent:!(!b||!b.rerenderContent)});return b&&b.waitUntilAllContentIsReady?this.isContentLoading():a},_applyReportData:function(a){var b=this;a=a||{};var c=this._reportData&&this._reportData.isMultiFeature?0:a.analysisAreaIndex||0,e=!1!==a.rerenderContent;this._analysisAreaIndex=c;this._showError(!this._reportData);if(this._reportData)return d(this._viewModel.initialize(this._reportData.isClassic,
this.viewMode),function(){b.playerToolbar.updateAreaSelect(b._reportData.analysisAreas,b._reportData.combinedAreasInfo,b.getCurrentAnalysisAreaIndex(),b._reportData.isMultiFeature);return d(b._setReportContainer(e),function(a){return a&&b._doApplyTemplateJson({analysisAreaIndex:c})})})},_doApplyTemplateJson:function(a){var b=this,c=this.getCurrentReportContainer(),e=c.fromJson(this._reportData.templateJson,{waitUntilAllContentIsReady:!0,progressCallback:function(c){b._progressController&&b._progressController.setProgressForAreaAt(c,
a.analysisAreaIndex)}}),f=c.getPagePromise?c.getPagePromise():e,c=c.getContentPromise?c.getContentPromise():e;this._registerContainerLoadPromise(c);return d(f,function(){this._setCurrentContainerLoaded();this.showPageAt(this._currentPageIndex);return this.resize()}.bind(this))},_loadQueue:null,isContentLoading:function(){return this._loadQueue&&this._loadQueue.getPromise()},_registerContainerLoadPromise:function(a){var b=this;this._loadQueue||(this._loadQueue=new O({onStarted:function(){g.enableContentAbsolute(b.commandButtonsContainer,
!1)},onFinished:function(){g.enableContentAbsolute(b.commandButtonsContainer,!0)}}));this._loadQueue.add(a)},getReportData:function(){return this._reportData},reportDataToJson:function(a){return this.dataProvider.reportDataToJson(this.getReportData(),a)},reportDataFromJson:function(a,b){return d(this.dataProvider.reportDataFromJson(a),function(a){return this.setReportData(a,b)}.bind(this))},updateTemplateJson:function(a){this._reportData&&a&&(this._reportData.templateJson=a)},getReportTitle:function(){return this._reportData&&
this._reportData.reportTitle||""},getCurrentAnalysisAreaIndex:function(){return this._analysisAreaIndex},getCurrentAnalysisArea:function(){return this._reportData&&this._reportData.analysisAreas[this._analysisAreaIndex]},getAnalysisAreas:function(){return this._reportData&&this._reportData.analysisAreas},_configureViewModel:function(a){var b=this;this._viewModel.setTheme(this._reportData.templateJson.theme);this._viewModel.enableDataDrilling=this.enableDataDrilling;this._disableAnimation&&(this._viewModel.animationAllowed=
!1);this._viewModel.setDynamicReportInfo({fieldData:this._reportData.fieldData,analysisAreas:this._reportData.analysisAreas,combinedAreasInfo:this._reportData.combinedAreasInfo,infographicOptions:this._reportData.infographicOptions,attachmentsStore:this._reportData.attachmentsStore,createMapFunc:h.hitch(this,this._createMap),reportType:this._reportData.reportType,isClassic:this._reportData.isClassic,isMultiFeature:this._reportData.isMultiFeature,isFixedDataMode:!this._reportData.config.geoenrichmentUrl,
geClient:this._reportData.geClient,templateVariableProvider:this._reportData.templateVariableProvider,countryID:this._reportData.config.countryID,hierarchy:this._reportData.config.hierarchy});this._viewModel.getDynamicImageFunc=h.hitch(this,this._getReportLogo);this._viewModel.enrichFieldData=function(a){return b.dataProvider.enrichFieldData(a,h.mixin({analysisAreas:b._reportData.analysisAreas,fieldData:b._reportData.fieldData},b._reportData.config))}},getNumberOfPages:function(){return this.getCurrentReportContainer().getNumberOfPages()},
notifyShown:function(){this._isDataBeingSetFlag||this.getCurrentReportContainer()&&this.getCurrentReportContainer().notifyShown()},_isErrorShown:!1,_showError:function(a){Q.emulateErrors.playerError&&(a=!0);g[a?"hide":"show"](this.printableDivContainer);g[a?"show":"hide"](this.errorViewDiv);f[a?"add":"remove"](this.domNode,"esriGEReportPlayerError");this._isErrorShown=!!a;a&&g.hide(this.sidePageNavigator);this.playerToolbar.setErrorShown(!!a);a&&(this._progressController&&this._progressController.reset(),
console.log(a),this.onError(a))},isErrorShown:function(){return this._isErrorShown},setPrintMode:function(a){f[a?"add":"remove"](this.domNode,"esriGEReportPlayerInPrinting")},resize:function(a,b){return d(this._resize({width:a,height:b}),function(){this._updatePageNavigator();this._updateZoomControls();this.playerToolbar.update()}.bind(this))},_pendingResizeEvent:null,_emitResizedEvent:function(a){this._pendingResizeEvent={isPaginating:!!a};this._isDataBeingSetFlag||this._emitPendingResizedEvent()},
_emitPendingResizedEvent:function(){this._pendingResizeEvent&&(this.onResized(this._pendingResizeEvent.isPaginating),this._pendingResizeEvent=null)},_onClose:function(){var a;this.showToFullScreenAnimation&&this.resizeMode===l.FIT_WINDOW&&(a=n.animateFrom(this));d(a,function(){this.onClose()}.bind(this))},onSetReportDataStart:function(){},onSetReportDataEnd:function(){},onResized:function(a){},onClose:function(){},onError:function(a){}})});