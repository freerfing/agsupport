// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.26/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/ReportTemplateData","dojo/_base/declare dojo/request/xhr dojo/promise/all esri/kernel esri/request esri/urlUtils esri/dijit/geoenrichment/utils/DataUtil".split(" "),function(g,h,k,l,m,n,e){return g(null,{id:null,_portal:null,_baseUrl:null,constructor:function(a,b){this.id=a.id;this._portal=b;this._baseUrl=this._portal.url+"/sharing/rest"},getFiles:function(){var a=this;return this._getResources().then(function(b){var f=[];b.resources.map(function(c){var d=
c.resource;if("thumbnail.png"!==d){c=a._baseUrl+"/"+a._contentItemPath(a.id+"/resources/"+d);var b=n.getProxyRule(c);f.push(h(b&&b.proxyUrl?b.proxyUrl+"?"+c:c,{method:"POST",handleAs:"arraybuffer",data:"token\x3d"+a._getToken(),headers:{"X-Requested-With":null,"Content-Type":"application/x-www-form-urlencoded; charset\x3dutf-8"}}).then(function(a){var b=!/\.xml$|\.txt$|\.json$/i.test(d);return{name:d,data:b?e.base64FromByteSource(a):decodeURIComponent(escape(e.binaryStringFromByteSource(a)))}}))}});
return k(f)})},_contentItemPath:function(a){return"content/items/"+a},_getToken:function(){return l.id.credentials[0].token},_getResources:function(){return m({url:this._baseUrl+"/"+this._contentItemPath(this.id+"/resources"),content:{num:100,f:"json",token:this._getToken()},handleAs:"json"},{usePost:!0})},getPortalUrl:function(a){return a?/[^:]+:\/\/(.+)$/i.exec(this._portal.url)[1]:this._portal.url}})});