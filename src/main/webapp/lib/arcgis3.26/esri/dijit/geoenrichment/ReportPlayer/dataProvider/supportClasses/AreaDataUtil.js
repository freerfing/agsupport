// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.26/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/AreaDataUtil",["dojo/_base/lang","../../core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoNameUtil","../../_devConfig"],function(l,r,t){var f={getAreaDataValue:function(a){function c(a){!1!==p&&(g=a[p]);void 0===g&&(g=a[b])}function e(){var a=k[h];a&&(0<=m?c(a.comparisonLevels[m]):c(a.data))}var b=a.fieldName,d=a.fieldData,k=a.areaDataObject,h=a.calculatorName,f=a.featureIndex,m=a.comparisonIndex,q=a.ignoreMetadata;isMultiFeature=
a.isMultiFeature;if(!t.showAreaDataUtilUndefinedData&&b){var n=b.indexOf("."),p=!1;-1!==n&&(p=b.substr(n+1));h||-1===n||(h=b.substr(0,n));f=void 0===f?0:Number(f)||0;if(k=a.areaDataObject||d.areaData[f]){var g;isMultiFeature&&h===r.AREA_ATTRIBUTES_CALCULATOR_NAME&&!q&&d&&c(d.metadata);void 0===g&&e();if(h)return g;void 0===g&&!q&&d&&c(d.metadata);if(void 0===g)for(var l in k)if(a=k[l],0<=m?c(a.comparisonLevels[m]):c(a.data),void 0!==g)break;return g}}},getAreaDataObjectCalculator:function(a,c,e){if(!a)return null;
var b=a[c];!b&&e&&(b=a[c]=f.createCalculator());return b},createCalculator:function(a,c){return{data:a||{},comparisonLevels:c||[]}},combineAreaDataObjectCalculators:function(a,c,e){var b=[],d=[];a.forEach(function(a){if(a=f.getAreaDataObjectCalculator(a,c))b.push(a.data),d=d.concat(a.comparisonLevels)});if(e&&e.removeDuplicates){var k=[],h={},l=Object.keys(d[0]);d.forEach(function(a){var b=function(a){var b="";l.forEach(function(c){b+=a[c]+";"});return b}(a);h[b]||(h[b]=!0,k.push(a))});d=k}return{thisAreas:b,
comparisonLevels:d}},setAreaDataValue:function(a,c,e,b,d){d=void 0===d?0:Number(d)||0;f.setAreaDataObjectValue(a,c,e[d],b)},setAreaDataObjectValue:function(a,c,e,b){e&&b&&(f.getAreaDataObjectCalculator(e,b,!0).data[a]=c)},mergeAreaData:function(a,c){c.forEach(function(c,b){(b=a[b])&&f.mergeAreaDataObjects(b,c)})},mergeAreaDataObjects:function(a,c){for(var e in a){var b=a[e],d=c[e];d?b.comparisonLevels.length!==d.comparisonLevels.length?console.log("Error: can't merge calculators with different comparison levels!"):
(l.mixin(d.data,b.data),b.comparisonLevels.forEach(function(a,b){l.mixin(d.comparisonLevels[b],a)})):c[e]=b}console.log("AreaDataUtil.js merging area data \x3d\x3e areaData");console.log(c)}};return f});